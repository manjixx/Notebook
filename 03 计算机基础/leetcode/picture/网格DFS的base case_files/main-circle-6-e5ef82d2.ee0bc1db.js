(window.nojMonomainwebpackJsonpproduction=window.nojMonomainwebpackJsonpproduction||[]).push([[28],{"+ik5":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a=function(){function e(){var e=this;this.callbacks=[],this.isScheduled=!1,this.runCallbacks=function(){var t=e.callbacks.shift();t?(t(),requestAnimationFrame(e.runCallbacks)):e.isScheduled=!1}}return e.prototype.add=function(e){var t=this;return this.callbacks.push(e),this.flush(),function(){return t.remove(e)}},e.prototype.remove=function(e){var t=this.callbacks.indexOf(e);-1!==t&&this.callbacks.splice(t,1)},e.prototype.flush=function(){this.isScheduled||(this.isScheduled=!0,requestAnimationFrame(this.runCallbacks))},e}()},"+qzo":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n("D57K"),i=n("ERkP"),r=n.n(i),o=n("GG6d"),d=r.a.forwardRef((function(e,t){return r.a.createElement(o.a,Object(a.__assign)({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"1em",height:"1em",fill:"currentColor",ref:t},e),r.a.createElement("path",{fillRule:"evenodd",d:"M16.091 4.929l-7.057 7.078 7.057 7.064a1 1 0 01-1.414 1.414l-7.764-7.77a1 1 0 010-1.415l7.764-7.785a1 1 0 111.415 1.414z",clipRule:"evenodd"}))}))},"3Xm+":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n("D57K"),i=n("ERkP"),r=n.n(i),o=n("GG6d"),d=r.a.forwardRef((function(e,t){return r.a.createElement(o.a,Object(a.__assign)({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"1em",height:"1em",fill:"currentColor",ref:t},e),r.a.createElement("path",{fillRule:"evenodd",d:"M5.527 5.527a7.5 7.5 0 0111.268 9.852l3.581 3.583a1 1 0 01-1.414 1.415l-3.582-3.583A7.501 7.501 0 015.527 5.527zm1.414 1.414a5.5 5.5 0 107.779 7.779A5.5 5.5 0 006.94 6.94z",clipRule:"evenodd"}))}))},"7r8c":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n("D57K"),i=n("ERkP"),r=n.n(i),o=n("GG6d"),d=r.a.forwardRef((function(e,t){return r.a.createElement(o.a,Object(a.__assign)({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"1em",height:"1em",fill:"currentColor",ref:t},e),r.a.createElement("path",{fillRule:"evenodd",d:"M3.64 10.98c.147 0 .312-.022.495-.066.183-.044.348-.12.495-.23.147-.11.271-.269.374-.474.103-.205.154-.462.154-.77V5.084c0-.499.077-.928.231-1.287.154-.36.363-.66.627-.902s.565-.422.902-.539c.337-.117.69-.176 1.056-.176H9.58v1.848H8.37c-.425 0-.693.14-.803.418-.11.279-.165.58-.165.902v4.136c0 .425-.08.788-.242 1.09-.161.3-.352.545-.572.736-.22.19-.455.337-.704.44-.25.103-.462.161-.638.176v.044c.176.015.389.062.638.143.25.08.484.216.704.407.22.19.41.447.572.77.161.323.242.74.242 1.254v4.004c0 .323.055.623.165.902.11.279.378.418.803.418h1.21v1.848H7.974c-.367 0-.719-.059-1.056-.176a2.573 2.573 0 01-.902-.539 2.586 2.586 0 01-.627-.902c-.154-.36-.231-.788-.231-1.287V14.61c0-.352-.051-.638-.154-.858a1.494 1.494 0 00-.374-.517 1.18 1.18 0 00-.495-.253 2.143 2.143 0 00-.495-.066V10.98zm16.72 2.04c-.161 0-.33.022-.506.066a1.184 1.184 0 00-.484.253 1.494 1.494 0 00-.374.517c-.103.22-.154.506-.154.858v4.202c0 .499-.077.928-.231 1.287-.154.36-.363.66-.627.902a2.573 2.573 0 01-.902.54c-.337.116-.69.175-1.056.175H14.42v-1.848h1.21c.425 0 .693-.14.803-.418.11-.279.165-.58.165-.902v-4.004c0-.513.08-.931.242-1.254.161-.323.352-.58.572-.77.22-.19.455-.326.704-.407.25-.08.462-.128.638-.143v-.044a2.225 2.225 0 01-.638-.176 2.567 2.567 0 01-.704-.44c-.22-.19-.41-.436-.572-.737-.161-.3-.242-.664-.242-1.089V5.452c0-.323-.055-.623-.165-.902-.11-.279-.378-.418-.803-.418h-1.21V2.284h1.606c.367 0 .719.059 1.056.176.337.117.638.297.902.539.264.242.473.543.627.902.154.36.231.788.231 1.287v4.356c0 .308.051.565.154.77.103.205.227.363.374.473.147.11.308.187.484.231.176.044.345.066.506.066v1.936z",clipRule:"evenodd"}))}))},"8McP":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n("D57K"),i=n("ERkP"),r=n.n(i),o=n("GG6d"),d=r.a.forwardRef((function(e,t){return r.a.createElement(o.a,Object(a.__assign)({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"1em",height:"1em",fill:"currentColor",ref:t},e),r.a.createElement("path",{fillRule:"evenodd",d:"M13 7a1 1 0 011-1h2a6 6 0 010 12h-2a1 1 0 110-2h2a4 4 0 000-8h-2a1 1 0 01-1-1zm-3 10a1 1 0 01-1 1H8A6 6 0 018 6h1a1 1 0 010 2H8a4 4 0 100 8h1a1 1 0 011 1zm-1-6h6a1 1 0 110 2H9a1 1 0 110-2z",clipRule:"evenodd"}))}))},"A+MG":function(e,t,n){"use strict";n.d(t,"g",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return m})),n.d(t,"f",(function(){return p})),n.d(t,"d",(function(){return g})),n.d(t,"e",(function(){return v})),n.d(t,"a",(function(){return f}));var a,i,r=n("D57K"),o=n("f7k3"),d=n("TMWK"),l=n("fgAA"),c=n("5ZzG"),u=Object(d.a)("div",{target:"e4aog6i0"})({display:"flex",alignItems:"center",flex:"0 0 auto"},"label:TopPart;"),s=Object(d.a)("div",{target:"e4aog6i1"})({flex:"1 1 auto",display:"flex",height:"42px",alignItems:"center",fontSize:"13px",color:l.a.grey(7)},"label:CommentInfo;"),m=Object(d.a)("div",{target:"e4aog6i2"})({marginRight:"5px",fontSize:"20px",fontFamily:"FetteMittelschrift, sans-serif"},"label:CommentNum;"),p=Object(d.a)(c.a,{target:"e4aog6i3"})({width:"14px",height:"14px",marginLeft:"4px"},"label:Icon;"),g=Object(d.a)("div",{target:"e4aog6i4"})({padding:"0 0 20px"},"label:EditorWrapper;"),b=Object(o.d)(i||(i=Object(r.__makeTemplateObject)(["\n  0% {\n    background-color: ",";\n  }\n  20% {\n    background-color: ",";\n  }\n  50% {\n    background-color: ",";\n  }\n  100% {\n    background-color: ",";\n  }\n"],["\n  0% {\n    background-color: ",";\n  }\n  20% {\n    background-color: ",";\n  }\n  50% {\n    background-color: ",";\n  }\n  100% {\n    background-color: ",";\n  }\n"])),l.b.Paper(),l.b.Primary0(),l.b.Primary0(),l.b.Paper()),v="flashing",f=Object(d.a)("div",{target:"e4aog6i5"})(((a={padding:"10px",margin:"0 -10px"})["&."+v]={animation:b+" 1.2s ease-in-out 500ms 2"},a),"label:BoxWrapper;")},HTDA:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n("D57K"),i=n("5Nzd"),r=n("u3dr"),o=n("2wT7"),d=n("9EWH"),l=n("3dHC"),c=n.n(l),u=n("HnWI"),s=n("rzNM"),m=n("Jg5f"),p=n("B07F"),g={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"officialAccountsUserCanUse"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"officialAccountsUserCanUse"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"realName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"userAvatar"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"userSlug"},arguments:[],directives:[]}]}}]}}],loc:{source:{body:"query officialAccountsUserCanUse {\n  officialAccountsUserCanUse {\n    realName\n    userAvatar\n    userSlug\n  }\n}"}},operationName:"officialAccountsUserCanUse",defName:"officialAccountsUserCanUse"},b=function(e){function t(t){var n=e.call(this)||this;return n.client=t,n.defaultState={officialAccounts:[],currentOfficialAccount:void 0,isModalActive:!1},n}var n,o,l,b,v,f,k;return Object(a.__extends)(t,e),t.prototype.showModal=function(e){e.isModalActive=!0},t.prototype.hideModal=function(e){e.isModalActive=!1},t.prototype.setCurrentOfficialAccount=function(e,t){e.currentOfficialAccount=t},t.prototype.setOfficialAccounts=function(e,t){e.officialAccounts=t},t.prototype.fetchOfficialAccounts=function(e){var t=this;return e.pipe(Object(s.a)((function(e){return t.client.query({query:g,variables:e}).pipe(Object(m.a)((function(e){var n=e.data;return t.getActions().setOfficialAccounts(c()(null===n||void 0===n?void 0:n.officialAccountsUserCanUse))})))})))},Object(a.__decorate)([Object(r.c)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",["function"===typeof(n="undefined"!==typeof d.Draft&&d.Draft)?n:Object]),Object(a.__metadata)("design:returntype",void 0)],t.prototype,"showModal",null),Object(a.__decorate)([Object(r.c)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",["function"===typeof(o="undefined"!==typeof d.Draft&&d.Draft)?o:Object]),Object(a.__metadata)("design:returntype",void 0)],t.prototype,"hideModal",null),Object(a.__decorate)([Object(r.c)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",["function"===typeof(l="undefined"!==typeof d.Draft&&d.Draft)?l:Object,Object]),Object(a.__metadata)("design:returntype",void 0)],t.prototype,"setCurrentOfficialAccount",null),Object(a.__decorate)([Object(r.c)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",["function"===typeof(b="undefined"!==typeof d.Draft&&d.Draft)?b:Object,Object]),Object(a.__metadata)("design:returntype",void 0)],t.prototype,"setOfficialAccounts",null),Object(a.__decorate)([Object(r.b)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",["function"===typeof(v="undefined"!==typeof u.a&&u.a)?v:Object]),Object(a.__metadata)("design:returntype","function"===typeof(f="undefined"!==typeof u.a&&u.a)?f:Object)],t.prototype,"fetchOfficialAccounts",null),t=Object(a.__decorate)([Object(i.a)(),Object(a.__metadata)("design:paramtypes",["function"===typeof(k="undefined"!==typeof p.a&&p.a)?k:Object])],t)}(o.a)},Hxrh:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var a=n("D57K"),i=n("ERkP"),r=n.n(i),o=n("6q4e"),d=n("TMWK"),l=n("5ZzG"),c=n("fgAA"),u=n("ZQQO"),s={light:{backgroundColor:c.a.grey(0),primaryColor:c.a.grey(8),secondaryColor:c.a.grey(4),disabledPrimaryColor:c.a.grey(4),disabledSecondaryColor:c.a.grey(3),disabledBackgroundColor:c.a.grey(1)},dark:{backgroundColor:c.a.grey(9),primaryColor:c.a.grey(0),secondaryColor:c.a.grey(0),disabledPrimaryColor:c.a.grey(5),disabledSecondaryColor:c.a.grey(6),disabledBackgroundColor:c.a.grey(7)},darkSide:{backgroundColor:c.a.grey(3),primaryColor:c.a.grey(8),secondaryColor:c.a.grey(6),disabledPrimaryColor:c.a.grey(4),disabledSecondaryColor:c.a.grey(3),disabledBackgroundColor:c.a.grey(1)}},m={lg:{height:u.a.lg,fontSize:14,padding:15},md:{height:u.a.md,fontSize:14,padding:13},sm:{height:u.a.sm,fontSize:12,padding:10},xs:{height:u.a.xs,fontSize:12,padding:8}},p=Object(d.a)("div",{target:"e1k8655i0"})({display:"inline-block",position:"relative"},"label:Container;"),g=Object(d.a)(l.a,{shouldForwardProp:o.a,target:"e1k8655i1"})((function(e){var t=e.sizeType;return{boxSizing:"content-box",position:"absolute",top:"50%",right:m[void 0===t?"md":t].padding-5,transform:"translateY(-50%)",width:14,height:14,padding:"5px",cursor:"pointer"}}),"label:Icon;"),b=Object(d.a)("input",{target:"e1k8655i2"})((function(e){var t=e.themeType,n=void 0===t?"light":t,i=e.sizeType,r=void 0===i?"md":i,o=e.hasIcon;return Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},function(e){var t=e.height,n=e.padding,a=e.fontSize,i=e.borderWidth,r=void 0===i?1:i,o=e.lineHeight;return{fontSize:a+"px",borderWidth:r+"px",padding:(t-a*(void 0===o?1.45:o))/2-r+"px "+n+"px"}}(m[r])),function(e){var t=e.primaryColor,n=e.secondaryColor,a=e.backgroundColor,i=e.disabledPrimaryColor,r=e.disabledSecondaryColor;return{outline:"none",borderStyle:"solid",borderRadius:"3px","&:not([disabled])":{color:t,background:a,borderColor:n,"&::placeholder":{color:n},"&:hover, &:focus":{borderColor:t}},"&[disabled]":{cursor:"not-allowed",color:i,borderColor:r,background:e.disabledBackgroundColor,"&::placeholder":{color:r}},transition:"color .3s, border-color .3s, background .3s"}}(s[n])),{width:"100%",paddingRight:o?2*m[r].padding+14:void 0})}),"label:BasicInput;"),v=function(e){var t=e.iconType,n=e.onClickIcon,i=e.inputRef,o=e.className,d=e.iconPosition,l=void 0===d?"left":d,c=Object(a.__rest)(e,["iconType","onClickIcon","inputRef","className","iconPosition"]),u=t&&r.a.createElement(g,{type:t,onClick:n,sizeType:c.sizeType});return r.a.createElement(p,{className:o},"left"===l&&u,r.a.createElement(b,Object(a.__assign)({},c,{ref:i,hasIcon:!!t})),"right"===l&&u)}},PXn6:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n("D57K"),i=n("ERkP"),r=n.n(i),o=n("GG6d"),d=r.a.forwardRef((function(e,t){return r.a.createElement(o.a,Object(a.__assign)({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"1em",height:"1em",fill:"currentColor",ref:t},e),r.a.createElement("path",{fillRule:"evenodd",d:"M5.5 5h1.866a.5.5 0 01.486.617l-.96 4a.5.5 0 01-.486.383H5.5a.5.5 0 01-.5-.5v-4a.5.5 0 01.5-.5zm8 0h1.866a.5.5 0 01.486.617l-.96 4a.5.5 0 01-.486.383H13.5a.5.5 0 01-.5-.5v-4a.5.5 0 01.5-.5z",clipRule:"evenodd"}))}))},Q0jv:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n("D57K"),i=n("3dHC"),r=n.n(i),o=n("ERkP"),d=n.n(o),l=n("TMWK"),c=n("v31z"),u=Object(l.a)("div",{target:"e1freqn70"})({display:"inline-flex",justifyContent:"space-between"},(function(e){return Object(a.__assign)({},e.style)}),"label:Wrapper;"),s=Object(l.a)(c.a,{target:"e1freqn71"})({minWidth:"24px",marginRight:"10px","&:nth-last-of-type(1)":{marginRight:0}},"label:Button;"),m=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.state={current:n.props.current||n.props.defaultCurrent||t.defaultCurrent},n.onClickPrevDot=function(){return n.updateCurrentPageNum(n.state.current-n.props.maxDisplayedPageBtnNum||1)},n.onClickNextDot=function(){var e=n.state.current+n.props.maxDisplayedPageBtnNum;n.updateCurrentPageNum(e>n.totalPage?n.totalPage:e)},n.onClickPrev=function(){return n.updateCurrentPageNum(n.state.current-1)},n.onClickNext=function(){return n.updateCurrentPageNum(n.state.current+1)},n.onSelectPage=function(e){n.updateCurrentPageNum(Number(e.currentTarget.dataset.page)||1)},n.updateCurrentPageNum=function(e){e!==n.state.current&&(e<1||e>n.totalPage||(void 0!==n.props.current?n.props.onChange&&n.props.onChange(e,n.props.numPerPage):n.setState({current:e},(function(){return n.props.onChange&&n.props.onChange(n.state.current,n.props.numPerPage)}))))},n}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"totalPage",{get:function(){return Math.ceil(this.props.totalNum/this.props.numPerPage)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasDotBtn",{get:function(){return this.totalPage>this.props.maxDisplayedPageBtnNum+2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"halfMaxDisplayedPageBtnNum",{get:function(){return Math.ceil(this.props.maxDisplayedPageBtnNum/2)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shouldRenderPrevDot",{get:function(){return this.hasDotBtn&&this.state.current-this.halfMaxDisplayedPageBtnNum>=2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shouldRenderNextDot",{get:function(){return this.hasDotBtn&&this.totalPage-this.state.current>this.halfMaxDisplayedPageBtnNum},enumerable:!1,configurable:!0}),t.getDerivedStateFromProps=function(e,t){return{current:void 0!==e.current?e.current:t.current}},t.prototype.componentDidMount=function(){},t.prototype.render=function(){var e=this;if(this.state.current<1)throw Error("Page should not be less than 1.");return this.props.totalNum<=this.props.numPerPage?null:d.a.createElement(u,{style:this.props.style},this.getRenderedBtnsProps().map((function(t){return d.a.createElement(s,Object(a.__assign)({},t,{disabled:e.props.disabled}))})))},t.prototype.getRenderedBtnsProps=function(){return this.totalPage<1?[this.getRenderedAngleBtnProps("prev"),this.getRenderedAngleBtnProps("next")]:r()(Object(a.__spread)([this.getRenderedAngleBtnProps("prev"),this.getRenderedPageBtnProps(1),this.shouldRenderPrevDot?this.getRenderedDotBtnProps("prev"):null],this.getPageItemsPropsByCurrent(),[this.shouldRenderNextDot?this.getRenderedDotBtnProps("next"):null,1===this.totalPage?null:this.getRenderedPageBtnProps(this.totalPage),this.getRenderedAngleBtnProps("next")]))},t.prototype.getRenderedPageBtnProps=function(e){return{type:this.state.current===e?"primary":this.props.inactiveButtonType,size:"xs","data-page":e,children:e,onClick:this.onSelectPage,key:e}},t.prototype.getRenderedDotBtnProps=function(e){return{type:"ghost",size:"xs",icon:"ellipsis",onClick:"prev"===e?this.onClickPrevDot:this.onClickNextDot,key:e+"-dot"}},t.prototype.getRenderedAngleBtnProps=function(e){var t=this;return{type:this.props.inactiveButtonType,size:"xs",icon:"prev"===e?"angle-left":"angle-right",onClick:"prev"===e?this.onClickPrev:this.onClickNext,key:e+"-angle",disabled:t.totalPage<1||"prev"===e&&1===t.state.current||"next"===e&&t.state.current===t.totalPage||void 0}},t.prototype.getPageItemsPropsByCurrent=function(){if(this.hasDotBtn){var e=this.state.current-this.halfMaxDisplayedPageBtnNum,t=this.state.current+this.halfMaxDisplayedPageBtnNum;return e<=0?this.getItems({start:2,length:this.props.maxDisplayedPageBtnNum-1}):t>=this.totalPage?this.getItems({start:this.totalPage-this.props.maxDisplayedPageBtnNum+1,length:this.props.maxDisplayedPageBtnNum-1}):this.getItems({start:this.state.current-this.halfMaxDisplayedPageBtnNum+1,length:this.props.maxDisplayedPageBtnNum})}return this.getItems({start:2,length:this.totalPage-2})},t.prototype.getItems=function(e){var t=this,n=e.start,a=e.length;return Array.from({length:a}).map((function(e,a){var i=n+a;return t.getRenderedPageBtnProps(i)}))},t.defaultCurrent=1,t.defaultProps={numPerPage:15,maxDisplayedPageBtnNum:5,inactiveButtonType:"default"},t}(d.a.PureComponent)},RwRN:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n("D57K"),i=n("ERkP"),r=n.n(i),o=n("GG6d"),d=r.a.forwardRef((function(e,t){return r.a.createElement(o.a,Object(a.__assign)({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"1em",height:"1em",fill:"currentColor",ref:t},e),r.a.createElement("path",{fillRule:"evenodd",d:"M15.392 7.765l5.695.832a.942.942 0 01.521 1.607l-4.12 4.014.972 5.67a.942.942 0 01-1.367.993L12 18.203 6.907 20.88a.942.942 0 01-1.367-.993l.972-5.67-4.12-4.014a.942.942 0 01.52-1.607l5.696-.832 2.547-5.16a.942.942 0 011.69 0l2.547 5.16z",clipRule:"evenodd"}))}))},Vw2C:function(e,t,n){"use strict";t.a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"topicCommentCount"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"topicId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"topic"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"topicId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"commentCount"},arguments:[],directives:[]}]}}]}}],loc:{source:{body:"query topicCommentCount($topicId: Int!) {\n  topic(id: $topicId) {\n    id\n    commentCount\n  }\n}\n"}},operationName:"topicCommentCount",defName:"topic"}},"Y+c1":function(e,t,n){"use strict";n.d(t,"a",(function(){return Qn}));var a=n("D57K"),i=n("K/af"),r=n("3dHC"),o=n.n(r),d=n("Ygfp"),l=n.n(d),c=n("ERkP"),u=n.n(c),s=n("60w7"),m=n("xqpu"),p=n("8JP3"),g=n("34li"),b=n("9KnD"),v=n("jWBs"),f=n("fgAA"),k=n("YnR9"),y=n("OJn1"),h=n("+ik5"),O=n("e96/"),j=n("tvc/"),_=n.n(j),N={};function C(e,t){t&&S(t),e.core.ruler.before("block","mention-plugin-rule",(function(e){var t=Object.keys(N).map((function(e){return _()(e)})).join("|");if(t){var n=new RegExp("@("+t+")","g");e.src=e.src.replace(n,(function(e,t){var n=N[t];return n?"["+e+"]("+k.a.main.paths.publicProfile.home({userSlug:n})+")":e}))}}))}function S(e){N=e}var x,I=n("PZQm"),F=n.n(I),P=n("SMYn"),E=n.n(P),R=n("RpsB"),w=n("mf+C"),D=n("r5Dk");function A(){if(x)return x;(x=new F.a({html:!1,linkify:!0,highlight:function(e,t){if(t)try{return R.a.highlight(t,e,!0).value}catch(e){}return R.a.highlightAuto(e).value||e},replaceLink:D.a})).disable(["table","blockquote","hr","reference","heading","lheading","html_block","strikethrough","emphasis","image","html_inline"]),x.use(C).use(E.a).use(w.a);var e=x.render.bind(x),t={};return x.render=function(n){return t[n]||(t[n]=e(n)),t[n]},x}var T=n("UqMZ"),B=n("ehcH"),M=n("u+Aj"),V=n("cPtI"),U=n("XKjd"),z=n("f7k3"),H=n("TMWK"),$=n("nnm9"),q=n.n($),L=n("1szP"),W=n("JFCy"),K=n("v31z"),G=n("/NrN"),Y=n("htYk");function Q(e){var t=e.onClick||q.a;return u.a.createElement(K.a,{className:e.className,icon:e.icon,type:"transparent",size:"xs",disabled:e.disabled,onClick:t},e.text)}var J=Object(z.d)(Z||(Z=Object(a.__makeTemplateObject)(["\n  0% {\n    background-color: transparent;\n    box-shadow: none;\n  }\n  40% {\n    background-color: ",";\n    box-shadow: 0 0 0 5px ",";\n  }\n  60% {\n    background-color: ",";\n    box-shadow: 0 0 0 5px ",";\n  }\n  100% {\n    background-color: transparent;\n    box-shadow: none;\n  }\n"],["\n  0% {\n    background-color: transparent;\n    box-shadow: none;\n  }\n  40% {\n    background-color: ",";\n    box-shadow: 0 0 0 5px ",";\n  }\n  60% {\n    background-color: ",";\n    box-shadow: 0 0 0 5px ",";\n  }\n  100% {\n    background-color: transparent;\n    box-shadow: none;\n  }\n"])),f.b.Primary0(),f.b.Primary0(),f.b.Primary0(),f.b.Primary0()),X=Object(H.a)("div",{target:"e19tnut60"})((function(e){return e.highlight?{animation:J+" 3s cubic-bezier(0.77, 0.01, 0.23, 1) 500ms"}:null}),{flex:"0 0 auto",display:"flex",flexDirection:"column",padding:"10px 0",position:"relative"},"label:CommentBody;");X.defaultProps=Object(a.__assign)(Object(a.__assign)({},X.defaultProps),{"data-cypress":"CommentBody"});var Z,ee,te,ne,ae,ie,re=Object(H.a)("div",{target:"e19tnut61"})({display:"flex",width:"100%",justifyContent:"space-between",marginBottom:"10px"},"label:CommentHeader;"),oe=Object(H.a)("div",{target:"e19tnut62"})({display:"flex",alignItems:"center"},"label:CommentAvatarWrapper;"),de=Object(H.a)("img",{target:"e19tnut63"})({width:"30px",height:"30px",borderRadius:"50%"},"label:CommentAvatar;"),le=(f.a.grey(7),Object(U.a)({marginLeft:"8px"})),ce=Object(H.a)("span",{target:"e19tnut65"})({fontSize:"14px",color:f.a.grey(5),lineHeight:"30px",'&[data-status="Deleted"]':{color:f.a.red(2)},'&[data-status="Pending"]':{color:f.a.grey(4)}},"label:CommentTime;"),ue=Object(H.a)("div",{target:"e19tnut66"})({margin:"0 15px",display:"flex",flexDirection:"column"},"label:ReplyCommentsWrapper;"),se=Object(H.a)(Q,{target:"e19tnut67"})((function(e){return{display:!1===e.visible?"none":"block",color:e.isDanger?f.a.red(5):void 0,userSelect:"none"}}),"label:ToolButton;"),me=Object(H.a)(G.a,{target:"e19tnut68"})({color:f.a.red(5),"&:hover:not([disabled])":{color:f.a.red(5)},svg:{width:"14px",height:"14px"}},"label:AdminButton;"),pe=Object(H.a)(Y.a,{target:"e19tnut69"})({textAlign:"center",color:f.a.red(5),fontSize:"12px"},"label:StyledMuteButton;"),ge=Object(H.a)("div",{target:"e19tnut610"})((function(e){return{display:e.visible?"flex":"none",margin:"5px 0 0"}}),"label:Toolbar;"),be=(f.a.grey(1),f.a.grey(1),f.a.grey(1),Object(L.renderWithSize)((function(e){return e&&e.width<=530?{size:W.d.SM}:{size:W.d.MD}}),(function(e){var t=e.size,n=e.repliesCount;return t===W.d.SM?u.a.createElement("span",null,""+n):u.a.createElement("span",null,n&&"\u67e5\u770b "+n+" \u6761\u56de\u590d")}))),ve=Object(z.b)({flexDirection:"row"},"label:errorWrap;"),fe=Object(H.a)("div",{target:"e19tnut617"})({background:f.a.grey(0),boxShadow:"inset 0 1px 6px "+f.a.grey(9,.1),padding:"5px 0 0",marginTop:"10px",borderRadius:"3px"},"label:CommentReplyWrapper;"),ke=Object(H.a)("div",{target:"e1hs3jt60"})({display:"flex",justifyContent:"flex-end"},"label:Wrapper;"),ye=Object(H.a)("div",{target:"e1hs3jt61"})((function(e){return{fontSize:"12px",lineHeight:"24px",color:e.isActive?f.a.grey(8):f.a.grey(6),cursor:"pointer",padding:"0 15px",position:"relative","&:not(:last-of-type)::after":{content:'""',height:"12px",width:"1px",background:f.a.grey(3),position:"absolute",right:"0px",top:"50%",transform:"translateY(-50%)"}}}),"label:Option;"),he=[{name:"\u6700\u65e9",key:g.A.OldToNew},{name:"\u6700\u65b0",key:g.A.NewToOld}],Oe=u.a.memo((function(e){var t=e.activeOption,n=e.onOptionClick,a=Object(c.useCallback)((function(e){var t=e.currentTarget.dataset.key;n(t)}),[]);return u.a.createElement(ke,null,he.map((function(e){var n=e.name,i=e.key;return u.a.createElement(ye,{key:i,"data-key":i,onClick:a,isActive:t===i},n)})))})),je=n("Q0jv"),_e=Object(H.a)("div",{target:"e6o0inv0"})({display:"flex",height:"55px",margin:"0 15px",borderTop:"1px solid "+f.a.grey(2),alignItems:"center",justifyContent:"center",position:"relative","> button":{color:f.a.grey(7),position:"absolute",left:0,top:"50%",transform:"translateY(-50%)"}},"label:Wrapper;"),Ne=u.a.memo((function(e){var t=e.page,n=e.totalNum,a=e.setRepliesPage,i=e.hideReplies,r=e.resetCommentReply,o=Object(c.useCallback)((function(){i(),r()}),[]);return u.a.createElement(_e,null,u.a.createElement(K.a,{size:W.e,type:"ghost",onClick:o,icon:"angle-up"},"\u6536\u8d77\u56de\u590d"),u.a.createElement(je.a,{current:t,totalNum:n,numPerPage:10,maxDisplayedPageBtnNum:5,onChange:a,inactiveButtonType:"ghost"}))})),Ce=n("CkJS"),Se=n("txck"),xe=n("T/5y"),Ie=Object(H.a)("div",{target:"e9bqj3q0"})({padding:"7px 10px"},"label:RenderContentWrapper;"),Fe=H.a.div(ee||(ee=Object(a.__makeTemplateObject)(["\n  ","\n  ","\n  \n  code {\n    ","\n    ","\n    padding: 2px 4px;\n    border-radius: 3px;\n  }\n  \n  pre {\n    ","\n    overflowX: auto;\n    overflowY: hidden;\n    border-radius: 3px;\n    padding: 5px 8px;\n    \n    code {\n      border: 0;\n      padding: 0;\n      background: transparent !important;\n    }\n  }\n  \n  ul, li {\n    margin: 4px 0;\n  }\n  \n  li {\n    line-height: 1.6;\n  }\n  \n  a {\n    color: ",";\n  }\n  \n  .user {\n    cursor: pointer;\n    color: ",";\n    \n    :hover {\n      text-decoration: underline;\n    },\n  }\n"],["\n  ","\n  ","\n  \n  code {\n    ","\n    ","\n    padding: 2px 4px;\n    border-radius: 3px;\n  }\n  \n  pre {\n    ","\n    overflowX: auto;\n    overflowY: hidden;\n    border-radius: 3px;\n    padding: 5px 8px;\n    \n    code {\n      border: 0;\n      padding: 0;\n      background: transparent !important;\n    }\n  }\n  \n  ul, li {\n    margin: 4px 0;\n  }\n  \n  li {\n    line-height: 1.6;\n  }\n  \n  a {\n    color: ",";\n  }\n  \n  .user {\n    cursor: pointer;\n    color: ",";\n    \n    :hover {\n      text-decoration: underline;\n    },\n  }\n"])),Ce.a.paragraph.sm,Se.a.primary,Se.a.secondary,xe.a.overlay,xe.a.overlay,f.a.blue(6),f.a.blue(6)),Pe=n("DuHN"),Ee=(n("IJu9"),n("lKcY")),Re=n("xdqw"),we=n("AnWY"),De=n("PXn6"),Ae=n("7r8c"),Te=n("8McP"),Be=n("wgQk"),Me=n("uC9H"),Ve=n("GG6d"),Ue=u.a.forwardRef((function(e,t){return u.a.createElement(Ve.a,Object(a.__assign)({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"1em",height:"1em",fill:"currentColor",ref:t},e),u.a.createElement("path",{fillRule:"evenodd",d:"M15.424 15.2a4.62 4.62 0 11-.742-6.947 1 1 0 011.985.176v4.524a1.714 1.714 0 003.429 0v-.905a8.048 8.048 0 10-3.155 6.39 1 1 0 111.216 1.588 10.048 10.048 0 113.939-7.978v.905a3.714 3.714 0 01-6.672 2.247zm-3.376-.533a2.62 2.62 0 100-5.238 2.62 2.62 0 000 5.238z",clipRule:"evenodd"}))})),ze=n("nXSc"),He=n("r3KU"),$e=Object(H.a)("div",{target:"e1h3itgv0"})({position:"relative",border:"1px solid "+f.a.grey(3),borderRadius:"3px",background:f.a.grey(0)},"label:Container;"),qe=Object(H.a)("textarea",{target:"e1h3itgv1"})({display:"block",outline:"none",resize:"none",width:"100%",padding:"7px 10px",border:"none",background:f.a.grey(0),borderTopLeftRadius:"3px",borderTopRightRadius:"3px",lineHeight:1.5,fontSize:"12px","&::placeholder":{color:f.a.grey(4)}},"label:TextArea;"),Le=Object(H.a)("div",{target:"e1h3itgv2"})({display:"flex",alignItems:"center",borderTop:"1px solid "+f.a.grey(3),padding:"0 5px 0 10px",height:"31px",userSelect:"none"},"label:Toolbar;"),We=Object(H.a)("div",{target:"e1h3itgv3"})((function(e){return Object(a.__assign)({marginTop:"-1px",padding:"4px 13px 5px",fontSize:"12px",lineHeight:"17px",alignSelf:"flex-start",flex:"0 0 auto"},e.isActive?{background:f.a.grey(0),color:f.a.grey(8),border:"1px solid "+f.a.grey(3),borderTop:"1px solid "+f.a.grey(0),borderBottomLeftRadius:"3px",borderBottomRightRadius:"3px"}:{background:"transparent",color:f.a.grey(5),cursor:"pointer"})}),"label:ModeTab;"),Ke=Object(H.a)("div",{target:"e1h3itgv4"})({flex:"1 0 0",height:"1px"},"label:ToolbarPlaceholder;"),Ge=Object(H.a)(G.a,{target:"e1h3itgv5"})({margin:"0 0 0 10px"},"label:SubmitButton;"),Ye=Object(H.a)("div",{target:"e1h3itgv6"})({flex:"0 1 auto",display:"flex",flexWrap:"nowrap",overflow:"hidden"},"label:IconWrapper;"),Qe=Object(H.a)(G.a,{target:"e1h3itgv7"})({marginLeft:"8px","&:first-of-type":{marginLeft:"20px"}},"label:IconButton;"),Je=n("lXyA"),Xe=n.n(Je),Ze=n("43Bo"),et=n.n(Ze),tt=n("uhKY"),nt=n("Hxrh"),at=n("5Nzd"),it=n("u3dr"),rt=n("2wT7"),ot=n("HnWI"),dt=n("lqvn"),lt=n("R+ki"),ct=n("AouM"),ut=n("Jg5f"),st=n("W/Ou"),mt=n("B07F"),pt={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"matchedUsers"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"namePrefix"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"topicId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"matchedUsers"},arguments:[{kind:"Argument",name:{kind:"Name",value:"namePrefix"},value:{kind:"Variable",name:{kind:"Name",value:"namePrefix"}}},{kind:"Argument",name:{kind:"Name",value:"topicId"},value:{kind:"Variable",name:{kind:"Name",value:"topicId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"username"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profile"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"realName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"userSlug"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"userAvatar"},arguments:[],directives:[]}]}}]}}]}}],loc:{source:{body:"query matchedUsers($namePrefix: String!, $topicId: Int!) {\n  matchedUsers(namePrefix: $namePrefix, topicId: $topicId) {\n    username\n    profile {\n      realName\n      userSlug\n      userAvatar\n    }\n  }\n}\n"}},operationName:"matchedUsers",defName:"matchedUsers"},gt=function(e){function t(t){var n=e.call(this)||this;return n.client=t,n.defaultState={searchedUsers:[],loading:!1},n}var n,i,r;return Object(a.__extends)(t,e),t.prototype.setSearchedUser=function(e,t){var n=t.data,i=t.loading,r=void 0!==i&&i,o=n.matchedUsers;return Object(a.__assign)(Object(a.__assign)({},e),{searchedUsers:Object(a.__spread)(o||[]),loading:r})},t.prototype.searchUser=function(e){var t=this;return e.pipe(Object(dt.a)(),Object(lt.a)(500),Object(ct.a)((function(e){var n=e.value,a=e.topicId;return t.client.query({query:pt,variables:{namePrefix:n,topicId:a}}).pipe(Object(ut.a)((function(e){var n=e.data;return t.getActions().setSearchedUser({data:n})})),Object(st.a)(t.getActions().setSearchedUser({data:{matchedUsers:[]},loading:!0})))})))},Object(a.__decorate)([Object(it.d)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",[Object,Object]),Object(a.__metadata)("design:returntype",Object)],t.prototype,"setSearchedUser",null),Object(a.__decorate)([Object(it.b)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",["function"===typeof(n="undefined"!==typeof ot.a&&ot.a)?n:Object]),Object(a.__metadata)("design:returntype","function"===typeof(i="undefined"!==typeof ot.a&&ot.a)?i:Object)],t.prototype,"searchUser",null),t=Object(a.__decorate)([Object(at.a)(),Object(a.__metadata)("design:paramtypes",["function"===typeof(r="undefined"!==typeof mt.a&&mt.a)?r:Object])],t)}(rt.a),bt=n("pqRN"),vt=Object(H.a)("div",{target:"e15utkg50"})(((te={background:f.a.grey(0),borderRadius:"3px",margin:"10px 0 0",width:"205px",boxShadow:"0 4px 16px 0 "+f.a.grey(9,.08),overflow:"auto",maxHeight:"300px"})[f.c]={background:f.a.grey(3),border:"1px solid "+f.a.grey(4),boxShadow:"0 1px 8px 0 rgba(0,0,0,.24)"},te),"label:AutoCompleteContainer;"),ft=function(e){var t=e.className;return u.a.createElement("div",{className:t},u.a.createElement(yt,null),u.a.createElement(ht,null,u.a.createElement(Ot,null),u.a.createElement(jt,null)))},kt=Object(H.a)(ft,{target:"e15utkg51"})({display:"flex",padding:"10px"},"label:MentionPlaceholder;"),yt=Object(H.a)("div",{target:"e15utkg52"})((function(e){var t,n=function(t){return e.url?"center/contain no-repeat url("+e.url+")":t?f.a.grey(4):f.a.grey(1)};return(t={background:n(!1),marginRight:"5px",width:"40px",height:"40px",borderRadius:"50%"})[f.c]={background:n(!0)},t}),"label:Avatar;"),ht=Object(H.a)("div",{target:"e15utkg53"})({flex:"1 0 0",display:"flex",flexDirection:"column",justifyContent:"center",overflow:"hidden"},"label:RightPart;"),Ot=Object(H.a)("div",{target:"e15utkg54"})(((ne={height:"18px",background:f.a.grey(1)})[f.c]={background:f.a.grey(4)},ne),"label:PlaceholderRow1;"),jt=Object(H.a)("div",{target:"e15utkg55"})(((ae={marginTop:"4px",width:"100px",height:"12px",background:f.a.grey(1)})[f.c]={background:f.a.grey(4)},ae),"label:PlaceholderRow2;"),_t=Object(H.a)("div",{target:"e15utkg56"})(Object(a.__assign)(Object(a.__assign)({},bt.l),{fontSize:"14px",lineHeight:"22px",color:f.a.grey(9)}),"label:DisplayName;"),Nt=Object(H.a)("div",{target:"e15utkg57"})(Object(a.__assign)(Object(a.__assign)({},bt.l),{fontSize:"12px",lineHeight:"18px",color:f.a.grey(5),transition:"color .3s"}),"label:Username;"),Ct=Object(H.a)("div",{target:"e15utkg58"})((function(e){var t,n;return(t={display:"flex",cursor:"pointer",padding:"10px",background:e.active?f.a.grey(1):f.a.grey(0),"&:hover":(n={},n[""+Nt]={color:f.a.grey(9)},n)})[f.c]={background:e.active?f.a.grey(4):f.a.grey(3),"&:hover":{background:f.a.grey(4)}},t}),"label:MentionedUser;"),St=Object(c.memo)((function(e){var t=Object(a.__read)(Object(c.useState)(""),2),n=t[0],r=t[1],o=Object(a.__read)(Object(c.useState)(""),2),d=o[0],l=o[1],s=Object(c.useRef)(null),m=e.onMentionUser,p=e.hideSelf,g=Object(a.__read)(Object(i.a)(gt,{scope:Ee.a}),2),b=g[0],v=g[1],k=Object(f.i)();Object(c.useEffect)((function(){var e;null===(e=null===s||void 0===s?void 0:s.current)||void 0===e||e.focus()}),[]);var y,h=Object(c.useCallback)((function(e){var t=b.searchedUsers.filter((function(t){return t.username===e}))[0];t&&m&&m(t)}),[b.searchedUsers,m]),O=Object(c.useCallback)((function(t){var n=t.currentTarget.value;r(n),v.searchUser({value:n,topicId:e.topicId})}),[r,v,e.topicId]),j=Object(c.useCallback)((function(e){e.stopPropagation()}),[]),_=Object(c.useCallback)((function(e){var t=b.searchedUsers,n=-1,a=t.length;if(0!==a){for(var i=0;i<a;i++)if(t[i].username===d){n=i;break}var r;r=-1===n?"prev"===e?t[a-1]:t[0]:"prev"===e?0===n?t[0]:t[n-1]:n===a-1?t[a-1]:t[n+1],l(r.username)}}),[b.searchedUsers,l,d]),N=Object(c.useCallback)((function(e){if("Escape"===e.key)p();else if("ArrowDown"===e.key)_("next");else if("ArrowUp"===e.key)_("prev");else if("Enter"===e.key){var t=b.searchedUsers[0],n=d||t&&t.username;n&&h(n)}}),[b.searchedUsers,d,_,p,h]),C=Object(c.useCallback)((function(e){e.stopPropagation();var t=e.currentTarget.dataset.username;t&&h(t)}),[h]);return u.a.createElement(u.a.Fragment,null,u.a.createElement(nt.a,{placeholder:"\u8f93\u5165\u4f60\u60f3 @ \u7684\u7528\u6237",sizeType:"xs",value:n,onChange:O,onClick:j,onKeyDown:N,theme:"dark"===k?"darkSide":"light",inputRef:s}),0===(y=b.loading?Array(4).fill(0).map((function(e,t){return u.a.createElement(kt,{key:t})})):b.searchedUsers.map((function(e){return function(e){var t;return u.a.createElement(Ct,{key:e.username,"data-username":e.username,active:e.username===d,onClick:C},u.a.createElement(yt,{url:Object(tt.b)(null!==(t=e.profile&&e.profile.userAvatar)&&void 0!==t?t:"",40)}),u.a.createElement(ht,null,u.a.createElement(_t,null,!!e.profile&&e.profile.realName),u.a.createElement(Nt,null,e.username)))}(e)}))).length?null:u.a.createElement(vt,null,y))})),xt=Object(H.a)("div",{target:"epuyubw0"})((function(e){return{position:"absolute",display:e.visible?"block":"none",top:e.top,left:e.left,zIndex:10}}),"label:MentionAnchorComp;"),It=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props.visible?this.props.children:null;return u.a.createElement(xt,Object(a.__assign)({},this.props),e)},t}(u.a.PureComponent);!function(e){e.InlineCode="code-inline",e.CodeBlock="code",e.Link="link",e.BulletList="list",e.NumberList="number-list",e.Mention="at"}(ie||(ie={}));var Ft,Pt,Et,Rt=function(e){function t(t){var n=e.call(this,t)||this;return n.state={mentionInfo:{top:0,left:0,visible:!1}},n.$textarea=n.props.innerRef,n.baseScrollHeight=50,n.minRows=2,n.selectionEnd=(n.props.defaultValue||"").length,n.nameMap=n.props.defaultMeta?n.props.defaultMeta.nameMap:{},n.onChange=function(e){var t=e.currentTarget.value;n.changeValueAndReflow(t)},n.changeValueAndReflow=function(e,t){n.props.onChange(e,t),n.refreshTextAreaHeight()},n.onFocus=function(){n.hideMentionInput()},n.onBlur=function(){n.syncSelectionState()},n.onKeyDown=function(e){var t=e.key;setTimeout((function(){n.syncSelectionState(),"@"===t&&n.showMentionInput()}),18)},n.onInsertRule=function(e){var t=n.getRuleTemplate(e),a=n.$textarea.current;a&&(a.value=a.value.substr(0,n.selectionEnd)+t+a.value.substr(n.selectionEnd),n.selectionEnd=n.selectionEnd+t.length,n.changeValueAndReflow(a.value),e===ie.Mention?n.showMentionInput():n.focusSelf())},n.onMentionUser=function(e){var t=n.$textarea.current,a=e.profile.realName;t&&(t.value=t.value.substr(0,n.selectionEnd)+a+t.value.substr(n.selectionEnd),n.selectionEnd=n.selectionEnd+a.length,n.nameMap[e.profile.realName]=e.username,n.changeValueAndReflow(t.value,{nameMap:n.nameMap}),n.focusSelf())},n.hideMentionInput=function(){n.setState({mentionInfo:{visible:!1,top:0,left:0}})},n.initialTextArea=Xe()(n.initialTextArea),n}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){this.parseCodeBlock(this.props.defaultValue),this.initialTextArea(),this.refreshTextAreaHeight(),this.props.setIconClickHandler(this.onInsertRule)},t.prototype.clear=function(){this.nameMap={},this.$textarea.current.value="",this.changeValueAndReflow("",{nameMap:this.nameMap})},t.prototype.render=function(){return u.a.createElement(u.a.Fragment,null,u.a.createElement(qe,{ref:this.$textarea,placeholder:this.props.placeholder,onChange:this.onChange,onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.onKeyDown,defaultValue:this.props.defaultValue}),u.a.createElement(It,Object(a.__assign)({},this.state.mentionInfo),u.a.createElement(St,{topicId:this.props.topicId,hideSelf:this.hideMentionInput,onSearch:this.props.onSearchUsers,onMentionUser:this.onMentionUser})))},t.prototype.parseCodeBlock=function(e){void 0===e&&(e="");var t=this.$textarea.current;t&&(t.value=e.replace(/```(\S*)\n((.|\n)*?)```/g,(function(e,t,n){return!t&&n.length>15?"```"+R.a.highlightAuto(n).language+"\n"+n+"```":e})))},t.prototype.focusSelf=function(){var e=this.$textarea.current;e&&(e.focus(),e.selectionEnd=this.selectionEnd)},t.prototype.initialTextArea=function(){var e=this.$textarea.current;if(e){var t=e.value;e.value="",this.baseScrollHeight=e.scrollHeight,e.value=t}},t.prototype.syncSelectionState=function(){var e=this.$textarea.current;e&&(this.selectionEnd=e.selectionEnd)},t.prototype.refreshTextAreaHeight=function(){var e=this.$textarea.current;if(e){e.rows=this.minRows;var t=Math.ceil((e.scrollHeight-this.baseScrollHeight)/18),n=this.props.maxRow||Number.POSITIVE_INFINITY;e.rows=Math.min(n,this.minRows+t)}},t.prototype.getRuleTemplate=function(e){switch(e){case ie.InlineCode:return" `your inline code...` ";case ie.CodeBlock:return"\n```\ncode block\n```\n";case ie.Link:return"[\u529b\u6263](https://leetcode-cn.com)";case ie.BulletList:return"\n- \u65e0\u5e8f\u5217\u8868";case ie.NumberList:return"\n1. \u6709\u5e8f\u5217\u8868";case ie.Mention:return" @";default:return""}},t.prototype.showMentionInput=function(){var e=this.$textarea.current;if(e){var t=et()(e,this.selectionEnd),n=t.top,a=t.left;this.setState({mentionInfo:{top:n-5,left:a+5,visible:!0}})}},t}(u.a.PureComponent);!function(e){e.Edit="edit",e.Preview="preview"}(Et||(Et={}));var wt=((Ft={})[ie.InlineCode]="\u884c\u5185\u4ee3\u7801",Ft[ie.CodeBlock]="\u4ee3\u7801\u5757",Ft[ie.Link]="\u94fe\u63a5",Ft[ie.BulletList]="\u65e0\u5e8f\u5217\u8868",Ft[ie.NumberList]="\u6709\u5e8f\u5217\u8868",Ft[ie.Mention]="@\u7528\u6237",Ft),Dt=((Pt={})[ie.InlineCode]=De.a,Pt[ie.CodeBlock]=Ae.a,Pt[ie.Link]=Te.a,Pt[ie.BulletList]=Be.a,Pt[ie.NumberList]=Me.a,Pt[ie.Mention]=Ue,Pt),At=Object(c.memo)((function(e){var t=Object(a.__read)(Object(c.useState)(Et.Edit),2),n=t[0],i=t[1],r=Object(a.__read)(Object(c.useState)(e.defaultMeta),2),o=r[0],d=r[1],l=Object(a.__read)(Object(c.useState)(e.defaultValue||""),2),s=l[0],m=l[1],p=Object(a.__read)(Object(c.useState)(null),2),g=p[0],b=p[1],v=e.submitResult,f=e.onClose,k=e.onChange,y=e.onSubmit,h=e.onMockSubmit,O=Object(c.useRef)(null),j=Object(c.useRef)(null);Object(c.useEffect)((function(){v&&v.ok&&(i(Et.Edit),m(""),d(void 0),O.current&&O.current.clear())}),[v]);var _=A(),N=Object(c.useCallback)((function(e){var t=e.currentTarget.dataset.mode;t&&i(t)}),[i]),C=Object(c.useCallback)((function(e,t){m(e),t&&d(t),k&&k(e,t)}),[k]),x=Object(c.useCallback)((function(){f&&f()}),[f]),I=Object(c.useCallback)((function(e){e.stopPropagation();var t=e.currentTarget.dataset.rule;t&&g&&g(t)}),[g]),F=Object(c.useCallback)((function(){y&&y(s,o)}),[y,s,o]),P=Object(c.useCallback)((function(){h&&h(s,o)}),[h,s,o]),E=Object(c.useCallback)((function(e){b((function(){return e}))}),[b]),R=function(e){var t=Dt[e];return u.a.createElement(ze.a,{content:wt[e],placement:"top"},u.a.createElement(Qe,{"data-rule":e,size:"xs",kind:"ghost",prefixIcon:u.a.createElement(t,null),disabled:"preview"===n,onClick:I}))};return u.a.createElement($e,{onClick:e.onClick},function(){if("edit"===n)return u.a.createElement(Rt,{topicId:e.topicId,ref:O,innerRef:j,placeholder:e.placeholder,defaultValue:s,defaultMeta:o,maxRow:e.maxRow,onChange:C,onSearchUsers:e.onSearchUsers,setIconClickHandler:E});var t=o&&o.nameMap;t&&S(t);var a=_.render(s);return u.a.createElement(Ie,null,u.a.createElement(Fe,{dangerouslySetInnerHTML:{__html:a}}))}(),u.a.createElement(Le,null,u.a.createElement(We,{isActive:"edit"===n,onClick:N,"data-mode":"edit"},"\u7f16\u8f91"),u.a.createElement(We,{isActive:"preview"===n,onClick:N,"data-mode":"preview"},"\u9884\u89c8"),u.a.createElement(Ye,null,R(ie.InlineCode),R(ie.CodeBlock),R(ie.Link),R(ie.BulletList),R(ie.NumberList),R(ie.Mention)),u.a.createElement(Ke,null),e.closable&&u.a.createElement(K.a,{size:"xs",type:"ghost",onClick:x},"\u53d6\u6d88"),u.a.createElement(He.a,{onConfirm:P,mockMode:He.b.Reply}),u.a.createElement(Ge,{size:"xs",kind:"primary",onClick:F,disabled:e.isSubmitting},e.primaryBtnText||"\u8bc4\u8bba")))})),Tt=n("HTDA"),Bt=Object(H.a)("div",{target:"equpptl0"})({height:"70px",border:"1px solid "+f.a.grey(2),borderRadius:"3px",background:f.a.grey(1),display:"flex",justifyContent:"center",alignItems:"center","& > div":{color:f.a.grey(6)},button:{margin:"0 10px"}},"label:Placeholder;");Bt.defaultProps=Object(a.__assign)(Object(a.__assign)({},Bt.defaultProps),{"data-cypress":"CommentPlaceHolder"});var Mt,Vt=n("U3QC"),Ut=n("wUZp"),zt={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"createCnComment"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"topicId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"content"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mentionedUserSlugs"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"parentCommentId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createCnComment"},arguments:[{kind:"Argument",name:{kind:"Name",value:"content"},value:{kind:"Variable",name:{kind:"Name",value:"content"}}},{kind:"Argument",name:{kind:"Name",value:"topicId"},value:{kind:"Variable",name:{kind:"Name",value:"topicId"}}},{kind:"Argument",name:{kind:"Name",value:"mentionedUserSlugs"},value:{kind:"Variable",name:{kind:"Name",value:"mentionedUserSlugs"}}},{kind:"Argument",name:{kind:"Name",value:"parentCommentId"},value:{kind:"Variable",name:{kind:"Name",value:"parentCommentId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ok"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"error"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"comment"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"commentFields"},directives:[]}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"commentFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CommentRelayNode"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"numChildren"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isEdited"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"post"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"voteUpCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"creationDate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updationDate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"voteStatus"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"author"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"username"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isDiscussAdmin"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profile"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userSlug"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"userAvatar"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"realName"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"mentionedUsers"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"username"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"userSlug"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"nickName"},arguments:[],directives:[]}]}}]}}]}}],loc:{source:{body:'#import "../../fragments/comment.graphql"\n\nmutation createCnComment(\n  $topicId: Int!\n  $content: String!\n  $mentionedUserSlugs: [String]\n  $parentCommentId: Int\n) {\n  createCnComment(\n    content: $content\n    topicId: $topicId\n    mentionedUserSlugs: $mentionedUserSlugs\n    parentCommentId: $parentCommentId\n  ) {\n    ok\n    error\n    comment {\n      ...commentFields\n    }\n  }\n}\n'}},operationName:"createCnComment",defName:"createCnComment"},Ht={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"officialCreateCnComment"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"content"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mentionedUserSlugs"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"officialAccountSlug"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"parentCommentId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},defaultValue:{kind:"IntValue",value:"0"},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"topicId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"officialCreateCnComment"},arguments:[{kind:"Argument",name:{kind:"Name",value:"content"},value:{kind:"Variable",name:{kind:"Name",value:"content"}}},{kind:"Argument",name:{kind:"Name",value:"mentionedUserSlugs"},value:{kind:"Variable",name:{kind:"Name",value:"mentionedUserSlugs"}}},{kind:"Argument",name:{kind:"Name",value:"officialAccountSlug"},value:{kind:"Variable",name:{kind:"Name",value:"officialAccountSlug"}}},{kind:"Argument",name:{kind:"Name",value:"parentCommentId"},value:{kind:"Variable",name:{kind:"Name",value:"parentCommentId"}}},{kind:"Argument",name:{kind:"Name",value:"topicId"},value:{kind:"Variable",name:{kind:"Name",value:"topicId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ok"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"error"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"comment"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"numChildren"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isEdited"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"post"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"voteUpCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"creationDate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updationDate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"voteStatus"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"author"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"username"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isDiscussAdmin"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profile"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userSlug"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"userAvatar"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"realName"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"mentionedUsers"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"username"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"userSlug"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"nickName"},arguments:[],directives:[]}]}}]}}]}}]}}]}}],loc:{source:{body:"mutation officialCreateCnComment($content: String!, $mentionedUserSlugs: [String], $officialAccountSlug: String!, $parentCommentId: Int = 0, $topicId: Int!) {\n  officialCreateCnComment(content: $content, mentionedUserSlugs: $mentionedUserSlugs, officialAccountSlug: $officialAccountSlug, parentCommentId: $parentCommentId, topicId: $topicId) {\n    ok\n    error\n    comment {\n      id\n      numChildren\n      isEdited\n      post {\n        id\n        content\n        voteUpCount\n        creationDate\n        updationDate\n        status\n        voteStatus\n        author {\n          username\n          isDiscussAdmin\n          profile {\n            userSlug\n            userAvatar\n            realName\n          }\n        }\n        mentionedUsers {\n          key\n          username\n          userSlug\n          nickName\n        }\n      }\n    }\n  }\n}\n"}},operationName:"officialCreateCnComment",defName:"officialCreateCnComment"},$t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"updateCnComment"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"content"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mentionedUserSlugs"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateComment"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"content"},value:{kind:"Variable",name:{kind:"Name",value:"content"}}},{kind:"Argument",name:{kind:"Name",value:"mentionedUserSlugs"},value:{kind:"Variable",name:{kind:"Name",value:"mentionedUserSlugs"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ok"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"error"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"comment"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"post"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"mentionedUsers"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"username"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"userSlug"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"nickName"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"comment"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isEdited"},arguments:[],directives:[]}]}}]}}]}}]}}]}}],loc:{source:{body:"mutation updateCnComment(\n  $id: Int!\n  $content: String!\n  $mentionedUserSlugs: [String]\n) {\n  updateComment(\n    id: $id\n    content: $content\n    mentionedUserSlugs: $mentionedUserSlugs\n  ) {\n    ok\n    error\n    comment {\n      id\n      post {\n        id\n        content\n        mentionedUsers {\n          key\n          username\n          userSlug\n          nickName\n        }\n        comment {\n          id\n          isEdited\n        }\n      }\n    }\n  }\n}\n"}},operationName:"updateCnComment",defName:"updateComment"},qt=n("L6nh");!function(e){e.TooShort="Your comment must be at least 3 characters long.",e.NotVerified="Not verified user"}(Mt||(Mt={}));var Lt=function(e){function t(t){var n=e.call(this)||this;return n.client=t,n.defaultState={submitting:!1,submitResult:{ok:!1,comment:{},error:""}},n}var n,i,r,o,d,l,c,u;return Object(a.__extends)(t,e),t.prototype.setBeforeSubmit=function(){return{submitting:!0,submitResult:{ok:!1,comment:{},error:""}}},t.prototype.setSubmitting=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{submitting:t})},t.prototype.setSubmitResult=function(e,t){var n=t.ok,i=t.comment,r=t.error;return Object(a.__assign)(Object(a.__assign)({},e),{submitResult:{ok:n||!1,comment:i||{},error:r||void 0},submitting:!1})},t.prototype.setUpdateResult=function(e,t){var n=t.ok,i=t.comment,r=t.error,o=i?{numChildren:0,isEdited:!1,post:i.post,id:String(i.id)}:{};return Object(a.__assign)(Object(a.__assign)({},e),{submitResult:{ok:n||!1,error:r||void 0,comment:o},submitting:!1})},t.prototype.submitReply=function(e){return this._reply(e,zt)},t.prototype.mockSubmitReply=function(e){return this._reply(e,Ht)},t.prototype.updateComment=function(e){var t=this;return e.pipe(Object(ct.a)((function(e){var n=e.commentId,a=e.content,i=e.mentionedUserSlugs;return t.client.mutate({mutation:$t,variables:{id:parseInt(n,10),content:a,mentionedUserSlugs:i}}).pipe(Object(ut.a)((function(e){var n=e.data;return n?t.getActions().setUpdateResult(n.updateComment):t.getActions().setSubmitting(!1)})),Object(st.a)(t.getActions().setBeforeSubmit()))})))},t.prototype._reply=function(e,t){var n=this;return e.pipe(Object(ct.a)((function(e){return n.client.mutate({mutation:t,variables:Object(a.__assign)(Object(a.__assign)({},e),{parentCommentId:e.parentId?parseInt(e.parentId,10):void 0})}).pipe(Object(Ut.a)(),Object(ut.a)((function(e){var t=e.data;if(t)return"officialCreateCnComment"in t?t.officialCreateCnComment:"createCnComment"in t?t.createCnComment:void 0})),Object(Vt.a)((function(e){var t=n.getErrMsg(null===e||void 0===e?void 0:e.error);t&&Pe.b.error(t)})),Object(ut.a)((function(e){return e?n.getActions().setSubmitResult(e):n.getActions().setSubmitting(!1)})),Object(st.a)(n.getActions().setBeforeSubmit()))})))},t.prototype.getErrMsg=function(e){if(!e)return"";switch(e){case Mt.TooShort:return"\u60a8\u7684\u8bc4\u8bba\u8fc7\u77ed";case Mt.NotVerified:return"\u8bf7\u5148\u9a8c\u8bc1\u60a8\u7684\u7535\u5b50\u90ae\u7bb1\u6216\u624b\u673a\u53f7";default:return"\u8bc4\u8bba\u53d1\u9001\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5"}},Object(a.__decorate)([Object(it.d)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",[]),Object(a.__metadata)("design:returntype",Object)],t.prototype,"setBeforeSubmit",null),Object(a.__decorate)([Object(it.d)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",[Object,Boolean]),Object(a.__metadata)("design:returntype",Object)],t.prototype,"setSubmitting",null),Object(a.__decorate)([Object(it.d)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",[Object,Object]),Object(a.__metadata)("design:returntype",Object)],t.prototype,"setSubmitResult",null),Object(a.__decorate)([Object(it.d)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",[Object,"function"===typeof(n="undefined"!==typeof qt.UpdateCnComment&&qt.UpdateCnComment.UpdateComment)?n:Object]),Object(a.__metadata)("design:returntype",Object)],t.prototype,"setUpdateResult",null),Object(a.__decorate)([Object(it.b)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",["function"===typeof(i="undefined"!==typeof ot.a&&ot.a)?i:Object]),Object(a.__metadata)("design:returntype","function"===typeof(r="undefined"!==typeof ot.a&&ot.a)?r:Object)],t.prototype,"submitReply",null),Object(a.__decorate)([Object(it.b)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",["function"===typeof(o="undefined"!==typeof ot.a&&ot.a)?o:Object]),Object(a.__metadata)("design:returntype","function"===typeof(d="undefined"!==typeof ot.a&&ot.a)?d:Object)],t.prototype,"mockSubmitReply",null),Object(a.__decorate)([Object(it.b)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",["function"===typeof(l="undefined"!==typeof ot.a&&ot.a)?l:Object]),Object(a.__metadata)("design:returntype","function"===typeof(c="undefined"!==typeof ot.a&&ot.a)?c:Object)],t.prototype,"updateComment",null),t=Object(a.__decorate)([Object(at.a)(),Object(a.__metadata)("design:paramtypes",["function"===typeof(u="undefined"!==typeof mt.a&&mt.a)?u:Object])],t)}(rt.a),Wt=Object(c.memo)((function(e){var t=Object(a.__read)(Object(i.a)(Lt,{scope:Ee.a}),2),n=t[0],r=t[1],o=Object(a.__read)(Object(i.a)(Tt.a),1)[0].currentOfficialAccount,d=Object(B.b)(),l=Object(Re.b)(we.o+e.userStatus.userSlug,{isSession:!0}),s=e.topicId,m=e.draftCacheKey,p=s+(void 0===m?"":m),g=l.get(p)||e.defaultValue;Object(c.useEffect)((function(){n.submitResult&&n.submitResult.ok&&e.onSubmitted&&e.onSubmitted(n.submitResult.comment)}),[n.submitResult]);var b=Object(c.useCallback)((function(){T.a.signIn({user:e.userStatus})}),[e.userStatus]),v=Object(c.useCallback)((function(t,n,i){T.a.ensurePhoneVerified(d((function(){var d,c=n&&Object.values(n.nameMap);if(t.length<3)Pe.b.error("\u8bc4\u8bba\u8fc7\u77ed");else{if(e.commentId)r.updateComment({commentId:e.commentId,content:t,mentionedUserSlugs:c}),e.tracker.submitComment("comment",c||[]);else{var u={content:t,topicId:e.topicId,parentId:e.parentId,mentionedUserSlugs:c};i?r.mockSubmitReply(Object(a.__assign)(Object(a.__assign)({},u),{officialAccountSlug:null!==(d=null===o||void 0===o?void 0:o.userSlug)&&void 0!==d?d:""})):r.submitReply(u),e.tracker.submitComment("reply",c||[])}l.remove(p)}})),{user:e.userStatus})()}),[e.commentId,e.topicId,e.parentId,e.userStatus,d,o]),f=Object(c.useCallback)((function(e,t){return v(e,t,!0)}),[v]),k=Object(c.useCallback)((function(e){l.set(p,e)}),[]);return e.userStatus.isSignedIn?u.a.createElement(At,{topicId:e.topicId,maxRow:10,primaryBtnText:e.commentId&&"\u786e\u5b9a",autoFocus:e.autoFocus,closable:!!e.parentId||!!e.commentId,defaultMeta:e.defaultMeta,defaultValue:g,submitResult:n.submitResult,isSubmitting:n.submitting,onClose:e.onCancel,onSubmit:v,onChange:k,onMockSubmit:f}):u.a.createElement(Bt,null,u.a.createElement("div",null,"\u8bf7\u5148",u.a.createElement(G.a,{kind:"primary",size:"xs",onClick:b},"\u767b\u5f55"),"\u540e\u53d1\u8868\u8bc4\u8bba"))})),Kt=Object(c.memo)((function(e){var t=Object(c.useContext)(m.d),n=e.post,a=n.mentionedUsers,i={};return a&&a.forEach((function(e){e&&(i[e.nickName]=e.userSlug)})),e.shouldShowCommentEditor?u.a.createElement(Wt,{autoFocus:!0,topicId:e.topicId,commentId:e.commentId,defaultValue:n.content,defaultMeta:{nameMap:i},tracker:e.tracker,onCancel:e.onHideEditComment,onSubmitted:e.onHideEditComment,userStatus:t}):(S(i),u.a.createElement(Fe,{dangerouslySetInnerHTML:{__html:A().render(n.content)}}))})),Gt=n("nPqx"),Yt=Object(c.memo)((function(e){var t=e.parentId,n=e.numChildren,a=e.commentId,i=e.onDelete,r=Object(c.useCallback)((function(){i(t,a)}),[i,t,a]);return e.isAbleToMutate?u.a.createElement(Gt.a,{visible:e.shouldShowDeleteConfirm,onClose:e.onHideDelete,onOk:r},n?"\u6b64\u8bc4\u8bba\u4e0b\u7684\u56de\u590d\u90fd\u4f1a\u88ab\u5220\u9664\uff0c\u60a8\u786e\u8ba4\u8981\u5220\u9664\u6b64\u8bc4\u8bba\u5417\uff1f":"\u60a8\u786e\u8ba4\u8981\u5220\u9664\u6b64"+(t===a?"\u8bc4\u8bba":"\u56de\u590d")+"\u5417\uff1f"):null})),Qt=Object(c.memo)((function(e){var t,n=Object(c.useContext)(m.d),a=e.onSubmit,i=e.onHideReplyBox,r=e.comment.post.author.profile,o=r.userSlug,d=r.realName,l={nameMap:(t={},t[d]=o,t)},s=Object(c.useCallback)((function(e){a(e)}),[a]);return u.a.createElement(Wt,{autoFocus:!0,topicId:e.topicId,draftCacheKey:e.comment.id,defaultValue:"@"+d+" ",defaultMeta:l,tracker:e.tracker,parentId:e.parentId,onCancel:i,onSubmitted:s,userStatus:n})})),Jt=n("Y9Gt"),Xt=n("sOys"),Zt=n("b+y+"),en=Object(c.memo)((function(e){var t=Object(c.useContext)(m.d),n=e.comment,a=e.generateShareUrl,i=t.commonNojPermissionTypes.includes(g.Qb.ColumnsReview),r=Object(c.useCallback)((function(){var e=a(n.id);O.a.copy(e,(function(){Pe.b.success("\u5df2\u590d\u5236\u5206\u4eab\u94fe\u63a5",1)}))}),[a,n]),o=function(a){var i=e.comment.post,r=i.voteStatus,o=i.voteUpCount,d=i.author,l=1===r,c=-1===r,s=t.userSlug===d.profile.userSlug,m="like"===a?l?0:1:c?0:-1,p=o+(l?-1:"like"===a?1:0),g="like"===a?o>0?o:"\u8d5e":"\u8e29",b="like"===a?l?"thumb-up":"thumb-up-o":c?"thumb-down":"thumb-down-o";return u.a.createElement(se,{icon:b,text:g,onClick:function(){e.toggleVote(n.post.id,m,p)},disabled:s})};return u.a.createElement(ge,{visible:!e.shouldShowReplyBox},o("like"),o("dislike"),u.a.createElement(se,{icon:"chat-o",text:u.a.createElement(be,{repliesCount:n.numChildren}),visible:!e.shouldRenderReplies&&n.numChildren>=1,onClick:e.onShowReplies}),u.a.createElement(se,{icon:"chat-o",text:"\u6536\u8d77\u56de\u590d",visible:e.shouldRenderReplies,onClick:e.onCloseReplies}),u.a.createElement(se,{icon:"reply-o",text:"\u56de\u590d",onClick:e.onShowReplyBox}),u.a.createElement(se,{icon:"share",text:"\u5206\u4eab",visible:e.shouldShowMoreTools,onClick:r}),u.a.createElement(se,{icon:"report",text:"\u4e3e\u62a5",visible:e.shouldShowMoreTools,onClick:e.toggleFlag}),e.isAbleToMutate&&u.a.createElement(se,{icon:"edit",text:"\u7f16\u8f91",isDanger:!!t.isSuperuser,visible:e.shouldShowMoreTools,onClick:e.editComment}),e.isAbleToMutate&&u.a.createElement(se,{icon:"bin",text:"\u5220\u9664",isDanger:!!t.isSuperuser,visible:e.shouldShowMoreTools,onClick:e.toggleDelete}),i&&e.shouldShowMoreTools&&u.a.createElement(Jt.a,{placement:"bottom",trigger:"click",content:u.a.createElement(Xt.a,null,u.a.createElement(Xt.a.Item,{key:"mute"},u.a.createElement(pe,{contentType:"Comment",value:"Muted"!==e.comment.post.status,id:parseInt(n.id,10)})))},u.a.createElement(me,{kind:"transparent",prefixIcon:u.a.createElement(Zt.a,null)})))})),tn=n("9EWH"),nn=n("pN2L"),an=n("eb+u"),rn=n("BUlm"),on=n("IMYO"),dn=n("rzNM"),ln=n("Vw2C"),cn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"commonTopicComments"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"topicId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"orderBy"}},type:{kind:"NamedType",name:{kind:"Name",value:"CommentOrderBy"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"skip"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"commonTopicComments"},arguments:[{kind:"Argument",name:{kind:"Name",value:"topicId"},value:{kind:"Variable",name:{kind:"Name",value:"topicId"}}},{kind:"Argument",name:{kind:"Name",value:"orderBy"},value:{kind:"Variable",name:{kind:"Name",value:"orderBy"}}},{kind:"Argument",name:{kind:"Name",value:"skip"},value:{kind:"Variable",name:{kind:"Name",value:"skip"}}},{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"IntValue",value:"15"}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalNum"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"edges"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"commentFields"},directives:[]}]}}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"commentFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CommentRelayNode"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"numChildren"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isEdited"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"post"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"voteUpCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"creationDate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updationDate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"voteStatus"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"author"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"username"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isDiscussAdmin"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profile"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userSlug"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"userAvatar"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"realName"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"mentionedUsers"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"username"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"userSlug"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"nickName"},arguments:[],directives:[]}]}}]}}]}}],loc:{source:{body:'#import "../../fragments/comment.graphql"\n\nquery commonTopicComments($topicId: Int!, $orderBy: CommentOrderBy, $skip: Int) {\n  commonTopicComments(\n    topicId: $topicId\n    orderBy: $orderBy\n    skip: $skip\n    first: 15\n  ) {\n    totalNum\n    edges {\n      node {\n        ...commentFields\n      }\n    }\n  }\n}\n'}},operationName:"commonTopicComments",defName:"commonTopicComments"},un={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"commentsSelection"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"topicId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"commentsSelection"},arguments:[{kind:"Argument",name:{kind:"Name",value:"topicId"},value:{kind:"Variable",name:{kind:"Name",value:"topicId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"commentFields"},directives:[]}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"commentFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CommentRelayNode"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"numChildren"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isEdited"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"post"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"voteUpCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"creationDate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updationDate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"voteStatus"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"author"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"username"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isDiscussAdmin"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profile"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userSlug"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"userAvatar"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"realName"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"mentionedUsers"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"username"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"userSlug"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"nickName"},arguments:[],directives:[]}]}}]}}]}}],loc:{source:{body:'#import "../../fragments/comment.graphql"\n\nquery commentsSelection($topicId: ID!) {\n  commentsSelection(topicId: $topicId) {\n    ...commentFields\n  }\n}\n'}},operationName:"commentsSelection",defName:"commentsSelection"},sn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"commentPage"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"commentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"orderBy"}},type:{kind:"NamedType",name:{kind:"Name",value:"CommentOrderBy"}},defaultValue:{kind:"EnumValue",value:"HOT"},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"replyOrderBy"}},type:{kind:"NamedType",name:{kind:"Name",value:"CommentReplyOrderBy"}},defaultValue:{kind:"EnumValue",value:"OLD_TO_NEW"},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"numPerPage"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},defaultValue:{kind:"IntValue",value:"15"},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"commentPage"},arguments:[{kind:"Argument",name:{kind:"Name",value:"commentId"},value:{kind:"Variable",name:{kind:"Name",value:"commentId"}}},{kind:"Argument",name:{kind:"Name",value:"orderBy"},value:{kind:"Variable",name:{kind:"Name",value:"orderBy"}}},{kind:"Argument",name:{kind:"Name",value:"replyOrderBy"},value:{kind:"Variable",name:{kind:"Name",value:"replyOrderBy"}}},{kind:"Argument",name:{kind:"Name",value:"numPerPage"},value:{kind:"Variable",name:{kind:"Name",value:"numPerPage"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"pageNum"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"replyPageNum"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"parentId"},arguments:[],directives:[]}]}}]}}],loc:{source:{body:"query commentPage($commentId: ID!, $orderBy: CommentOrderBy = HOT, $replyOrderBy: CommentReplyOrderBy = OLD_TO_NEW, $numPerPage: Int = 15) {\n  commentPage(commentId: $commentId, orderBy: $orderBy, replyOrderBy: $replyOrderBy, numPerPage: $numPerPage) {\n    pageNum\n    replyPageNum\n    parentId\n  }\n}\n"}},operationName:"commentPage",defName:"commentPage"},mn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"commentReplyConnection"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"commentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"orderBy"}},type:{kind:"NamedType",name:{kind:"Name",value:"CommentReplyOrderBy"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"skip"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"first"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"commentReplyConnection"},arguments:[{kind:"Argument",name:{kind:"Name",value:"commentId"},value:{kind:"Variable",name:{kind:"Name",value:"commentId"}}},{kind:"Argument",name:{kind:"Name",value:"orderBy"},value:{kind:"Variable",name:{kind:"Name",value:"orderBy"}}},{kind:"Argument",name:{kind:"Name",value:"skip"},value:{kind:"Variable",name:{kind:"Name",value:"skip"}}},{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"Variable",name:{kind:"Name",value:"first"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalNum"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"edges"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"commentFields"},directives:[]}]}}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"commentFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CommentRelayNode"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"numChildren"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isEdited"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"post"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"voteUpCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"creationDate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updationDate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"voteStatus"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"author"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"username"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isDiscussAdmin"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profile"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userSlug"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"userAvatar"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"realName"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"mentionedUsers"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"username"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"userSlug"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"nickName"},arguments:[],directives:[]}]}}]}}]}}],loc:{source:{body:'#import "../../fragments/comment.graphql"\n\nquery commentReplyConnection($commentId: ID!, $orderBy: CommentReplyOrderBy, $skip: Int, $first: Int) {\n  commentReplyConnection(commentId: $commentId, orderBy: $orderBy, skip: $skip, first: $first) {\n    totalNum\n    edges {\n      node {\n        ...commentFields\n      }\n    }\n  }\n}\n'}},operationName:"commentReplyConnection",defName:"commentReplyConnection"},pn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"votePost"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"postId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"voteStatus"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"votePost"},arguments:[{kind:"Argument",name:{kind:"Name",value:"postId"},value:{kind:"Variable",name:{kind:"Name",value:"postId"}}},{kind:"Argument",name:{kind:"Name",value:"value"},value:{kind:"Variable",name:{kind:"Name",value:"voteStatus"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ok"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"error"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"post"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"voteStatus"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"voteUpCount"},arguments:[],directives:[]}]}}]}}]}}],loc:{source:{body:"mutation votePost($postId: Int!, $voteStatus: Int!) {\n  votePost(postId: $postId, value: $voteStatus) {\n    ok\n    error\n    value\n    post {\n      id\n      voteStatus\n      voteUpCount\n    }\n  }\n}\n"}},operationName:"votePost",defName:"votePost"},gn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"deleteComment"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"commentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteComment"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"commentId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ok"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"error"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"post"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]}]}}]}}]}}],loc:{source:{body:"mutation deleteComment($commentId: Int!) {\n  deleteComment(id: $commentId) {\n    ok\n    error\n    post {\n      id\n      status\n    }\n  }\n}\n"}},operationName:"deleteComment",defName:"deleteComment"};Object(tn.d)();var bn,vn,fn={page:1,replyCount:0,orderBy:g.A.OldToNew,replies:[],loading:!1},kn=function(e){function t(t){var n=e.call(this)||this;return n.client=t,n.defaultState={topicId:null,totalNum:0,loadingComments:!1,currentPage:1,currentReplyPage:null,parentId:null,order:g.z.Hot,comments:{edges:[],totalNum:0},commentsSelection:[],topLevelNum:null,highlightCommentId:null,replyMap:new Map,replyingId:null,editingId:null},n}var n,i,r,o,d,l,c,u,s,m,p,b,v,f,k,y,h,O,j,_,N,C,S,x,I,F,P;return Object(a.__extends)(t,e),t.prototype.noop=function(e){return e},t.prototype.setTopicId=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{topicId:t})},t.prototype.setOrderBy=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{order:t})},t.prototype.setHighlightCommentId=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{highlightCommentId:t})},t.prototype.setCurrentPage=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{currentPage:t})},t.prototype.setTotalNumByDiff=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{totalNum:e.totalNum+t})},t.prototype.setReplyingId=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{replyingId:t})},t.prototype.setEditingId=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{editingId:t})},t.prototype.updateTotalNum=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{totalNum:t})},t.prototype.updateDetail=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),t)},t.prototype.updatePageInfo=function(e,t){var n=t.pageNum,i=t.replyPageNum,r=t.parentId;return Object(a.__assign)(Object(a.__assign)({},e),{parentId:r,currentPage:n,currentReplyPage:i})},t.prototype.updateCommentReply=function(e,t){var n=t.data,a=t.commentId,i=t.loading,r=void 0!==i&&i,o=n.commentReplyConnection,d=e.replyMap,l=e.parentId,c=e.currentReplyPage,u=e.highlightCommentId;if(o){var s=o.edges,m=o.totalNum,p=s&&s.filter((function(e){return"Deleted"!==e.node.post.status})),b=d.get(a),v=u&&l===a&&c;e.replyMap=d.set(a,{page:v?c:b&&b.page||1,replyCount:m,orderBy:b&&b.orderBy||g.A.OldToNew,replies:p,loading:r}),v&&(e.currentReplyPage=null)}},t.prototype.updateCommentReplyLoading=function(e,t){var n=e.replyMap,i=n.get(t)||fn;e.replyMap=n.set(t,Object(a.__assign)(Object(a.__assign)({},i),{loading:!0}))},t.prototype.updateCommentReplyPage=function(e,t){var n=t.commentId,i=t.page,r=e.replyMap,o=r.get(n)||fn;e.replyMap=r.set(n,Object(a.__assign)(Object(a.__assign)({},o),{page:i}))},t.prototype.updateCommentReplyOrderBy=function(e,t){var n=t.commentId,i=t.orderBy,r=e.replyMap,o=r.get(n)||fn;e.replyMap=r.set(n,Object(a.__assign)(Object(a.__assign)({},o),{orderBy:i}))},t.prototype.updateCommentCount=function(e,t){var n=t.id,a=e.comments.edges.findIndex((function(e){return e.node.id===n})),i=e.commentsSelection.findIndex((function(e){return e.id===n}));-1!==a&&(e.comments.edges[a].node.numChildren+=1),-1!==i&&(e.commentsSelection[i].numChildren+=1),e.totalNum+=1},t.prototype.deleteReply=function(e,t){var n=t.id,a=t.parentId,i=e.replyMap;if(n!==a&&i.has(a)){var r=i.get(a),o=r.replies.findIndex((function(e){return e.node.id===n}));-1!==o&&r.replies.splice(o,1),r.replyCount-=1;var d=e.comments.edges.findIndex((function(e){return e.node.id===a})),l=e.commentsSelection.findIndex((function(e){return e.id===a}));-1!==d&&(e.comments.edges[d].node.numChildren-=1),-1!==l&&(e.commentsSelection[l].numChildren-=1)}},t.prototype.updateResetCommentReply=function(e,t){var n=e.replyMap;n.has(t)&&(e.replyMap=n.set(t,fn))},t.prototype.updateVoteCache=function(e,t){var n=t.commentId,i=t.parentId,r=t.status,o=t.newCount;if(n===i){var d=e.comments.edges.findIndex((function(e){return e.node.id===n})),l=e.commentsSelection.findIndex((function(e){return e.id===n})),c=Object(tn.e)(e.comments,(function(e){-1!==d&&(e.edges[d].node.post.voteStatus=r,e.edges[d].node.post.voteUpCount=o)})),u=Object(tn.e)(e.commentsSelection,(function(e){-1!==l&&(e[l].post.voteStatus=r,e[l].post.voteUpCount=o)}));return Object(a.__assign)(Object(a.__assign)({},e),{comments:c,commentsSelection:u})}var s=e.replyMap;if(!s.has(i))return e;var m=Object(tn.e)(s.get(i),(function(e){var t=e.replies.findIndex((function(e){return e.node.id===n}));e.replies[t].node.post.voteStatus=r,e.replies[t].node.post.voteUpCount=o}));return s.set(i,m),Object(a.__assign)(Object(a.__assign)({},e),{replyMap:new Map(s)})},t.prototype.deleteCommentInState=function(e,t){e.commentsSelection=e.commentsSelection.filter((function(e){return e.post.id!==t})),e.comments.edges=e.comments.edges.filter((function(e){return e.node.post.id!==t}))},t.prototype.getTotalNum=function(e,t){var n=this;return e.pipe(Object(an.a)(t),Object(ct.a)((function(e){var t=Object(a.__read)(e,2)[1];return n.client.query({query:ln.a,variables:{topicId:t.topicId}}).pipe(Object(ut.a)((function(e){var t=e.data;return t.topic?n.getActions().updateTotalNum(t.topic.commentCount):n.getActions().noop()})))})))},t.prototype.getCurrentPage=function(e,t){var n=this;return e.pipe(Object(an.a)(t),Object(ct.a)((function(e){var t,i=Object(a.__read)(e,2)[1],r=n.client.watchQuery({query:cn,fetchPolicy:"network-only",variables:{topicId:i.topicId,skip:15*(i.currentPage-1),orderBy:i.order}});return t=i.order===g.z.Hot&&1===i.currentPage?n.client.watchQuery({query:un,fetchPolicy:"network-only",variables:{topicId:String(i.topicId)}}).pipe(Object(ut.a)((function(e){var t=e.data;return t&&t.commentsSelection}))):Object(nn.a)([]),r.pipe(Object(ut.a)((function(e){var t=e.data;return t&&t.commonTopicComments})),Object(rn.a)(t),Object(ut.a)((function(e){var t=Object(a.__read)(e,2),i=t[0],r=t[1];if(i&&r){var o=i.edges;return n.getActions().updateDetail({loadingComments:!1,comments:Object(a.__assign)(Object(a.__assign)({},i),{edges:o.filter((function(e){return"Deleted"!==e.node.post.status}))}),commentsSelection:r.filter((function(e){return"Deleted"!==e.post.status})),topLevelNum:i.totalNum})}return n.getActions().noop()})),Object(st.a)(n.getActions().updateDetail({loadingComments:!0})))})))},t.prototype.getPageInfo=function(e){var t=this;return e.pipe(Object(ct.a)((function(e){var n={pageNum:1,replyPageNum:null,parentId:null};return e?t.client.query({query:sn,variables:{commentId:e}}).pipe(Object(ut.a)((function(e){var t=e.data;return t.commentPage?{pageNum:t.commentPage.pageNum,replyPageNum:t.commentPage.replyPageNum,parentId:t.commentPage.parentId}:n})),Object(on.a)((function(){return Object(nn.a)(n)}))):Object(nn.a)(n)})),Object(ut.a)((function(e){return t.getActions().updatePageInfo({pageNum:e.pageNum,replyPageNum:e.replyPageNum||null,parentId:e.parentId||null})})))},t.prototype.getCommentReply=function(e){var t=this;return e.pipe(Object(ct.a)((function(e){var n=e.commentId,a=e.page,i=e.orderBy;return t.client.watchQuery({query:mn,variables:{commentId:n,orderBy:i,first:10,skip:10*(a-1)},fetchPolicy:"network-only"}).pipe(Object(ut.a)((function(e){var a=e.data;return t.getActions().updateCommentReply({data:a,commentId:n})})),Object(st.a)(t.getActions().updateCommentReplyLoading(n)))})))},t.prototype.vote=function(e){var t=this;return e.pipe(Object(dn.a)((function(e){var n=e.postId,a=e.status,i=e.newCount;return t.client.mutate({mutation:pn,variables:{postId:n,voteStatus:a},optimisticResponse:{votePost:{__typename:"VotePost",ok:!0,error:null,value:i,post:{__typename:"PostNode",id:n,voteStatus:i,voteUpCount:i}}}}).pipe(Object(ut.a)((function(){return t.getActions().noop()})))})))},t.prototype.deleteComment=function(e){var t=this;return e.pipe(Object(dn.a)((function(e){return t.client.mutate({mutation:gn,variables:{commentId:e}}).pipe(Object(Ut.a)("\u5220\u9664\u5931\u8d25"),Object(ut.a)((function(e){var n=e.data;return t.getActions().deleteCommentInState(n.deleteComment.post.id)})))})))},t.prototype.searchUser=function(e){var t=this;return e.pipe(Object(dn.a)((function(e){var n=e.namePrefix,a=e.topicId;return t.client.query({query:pt,variables:{namePrefix:n,topicId:a}}).pipe(Object(ut.a)((function(e){var t=e.data.matchedUsers;return t||[]})),Object(ut.a)((function(e){return e.filter((function(e){return e&&!!e.profile&&!!e.profile.realName}))})),Object(ut.a)((function(){return t.getActions().noop()})))})))},Object(a.__decorate)([Object(it.d)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",[Object]),Object(a.__metadata)("design:returntype",Object)],t.prototype,"noop",null),Object(a.__decorate)([Object(it.d)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",[Object,Object]),Object(a.__metadata)("design:returntype",Object)],t.prototype,"setTopicId",null),Object(a.__decorate)([Object(it.d)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",[Object,"function"===typeof(n="undefined"!==typeof g.z&&g.z)?n:Object]),Object(a.__metadata)("design:returntype",Object)],t.prototype,"setOrderBy",null),Object(a.__decorate)([Object(it.d)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",[Object,Object]),Object(a.__metadata)("design:returntype",Object)],t.prototype,"setHighlightCommentId",null),Object(a.__decorate)([Object(it.d)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",[Object,Number]),Object(a.__metadata)("design:returntype",Object)],t.prototype,"setCurrentPage",null),Object(a.__decorate)([Object(it.d)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",[Object,Number]),Object(a.__metadata)("design:returntype",Object)],t.prototype,"setTotalNumByDiff",null),Object(a.__decorate)([Object(it.d)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",[Object,Object]),Object(a.__metadata)("design:returntype",Object)],t.prototype,"setReplyingId",null),Object(a.__decorate)([Object(it.d)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",[Object,Object]),Object(a.__metadata)("design:returntype",Object)],t.prototype,"setEditingId",null),Object(a.__decorate)([Object(it.d)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",[Object,Number]),Object(a.__metadata)("design:returntype",Object)],t.prototype,"updateTotalNum",null),Object(a.__decorate)([Object(it.d)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",[Object,"function"===typeof(i="undefined"!==typeof Partial&&Partial)?i:Object]),Object(a.__metadata)("design:returntype",Object)],t.prototype,"updateDetail",null),Object(a.__decorate)([Object(it.d)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",[Object,Object]),Object(a.__metadata)("design:returntype",Object)],t.prototype,"updatePageInfo",null),Object(a.__decorate)([Object(it.c)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",["function"===typeof(r="undefined"!==typeof tn.Draft&&tn.Draft)?r:Object,Object]),Object(a.__metadata)("design:returntype",void 0)],t.prototype,"updateCommentReply",null),Object(a.__decorate)([Object(it.c)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",["function"===typeof(o="undefined"!==typeof tn.Draft&&tn.Draft)?o:Object,String]),Object(a.__metadata)("design:returntype",void 0)],t.prototype,"updateCommentReplyLoading",null),Object(a.__decorate)([Object(it.c)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",["function"===typeof(d="undefined"!==typeof tn.Draft&&tn.Draft)?d:Object,Object]),Object(a.__metadata)("design:returntype",void 0)],t.prototype,"updateCommentReplyPage",null),Object(a.__decorate)([Object(it.c)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",["function"===typeof(l="undefined"!==typeof tn.Draft&&tn.Draft)?l:Object,Object]),Object(a.__metadata)("design:returntype",void 0)],t.prototype,"updateCommentReplyOrderBy",null),Object(a.__decorate)([Object(it.c)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",["function"===typeof(c="undefined"!==typeof tn.Draft&&tn.Draft)?c:Object,Object]),Object(a.__metadata)("design:returntype",void 0)],t.prototype,"updateCommentCount",null),Object(a.__decorate)([Object(it.c)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",["function"===typeof(u="undefined"!==typeof tn.Draft&&tn.Draft)?u:Object,Object]),Object(a.__metadata)("design:returntype",void 0)],t.prototype,"deleteReply",null),Object(a.__decorate)([Object(it.c)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",["function"===typeof(s="undefined"!==typeof tn.Draft&&tn.Draft)?s:Object,String]),Object(a.__metadata)("design:returntype",void 0)],t.prototype,"updateResetCommentReply",null),Object(a.__decorate)([Object(it.d)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",[Object,Object]),Object(a.__metadata)("design:returntype",Object)],t.prototype,"updateVoteCache",null),Object(a.__decorate)([Object(it.c)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",["function"===typeof(m="undefined"!==typeof tn.Draft&&tn.Draft)?m:Object,Number]),Object(a.__metadata)("design:returntype",void 0)],t.prototype,"deleteCommentInState",null),Object(a.__decorate)([Object(it.b)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",["function"===typeof(p="undefined"!==typeof ot.a&&ot.a)?p:Object,"function"===typeof(b="undefined"!==typeof ot.a&&ot.a)?b:Object]),Object(a.__metadata)("design:returntype","function"===typeof(v="undefined"!==typeof ot.a&&ot.a)?v:Object)],t.prototype,"getTotalNum",null),Object(a.__decorate)([Object(it.b)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",["function"===typeof(f="undefined"!==typeof ot.a&&ot.a)?f:Object,"function"===typeof(k="undefined"!==typeof ot.a&&ot.a)?k:Object]),Object(a.__metadata)("design:returntype","function"===typeof(y="undefined"!==typeof ot.a&&ot.a)?y:Object)],t.prototype,"getCurrentPage",null),Object(a.__decorate)([Object(it.b)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",["function"===typeof(h="undefined"!==typeof ot.a&&ot.a)?h:Object]),Object(a.__metadata)("design:returntype","function"===typeof(O="undefined"!==typeof ot.a&&ot.a)?O:Object)],t.prototype,"getPageInfo",null),Object(a.__decorate)([Object(it.b)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",["function"===typeof(j="undefined"!==typeof ot.a&&ot.a)?j:Object]),Object(a.__metadata)("design:returntype","function"===typeof(_="undefined"!==typeof ot.a&&ot.a)?_:Object)],t.prototype,"getCommentReply",null),Object(a.__decorate)([Object(it.b)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",["function"===typeof(N="undefined"!==typeof ot.a&&ot.a)?N:Object]),Object(a.__metadata)("design:returntype","function"===typeof(C="undefined"!==typeof ot.a&&ot.a)?C:Object)],t.prototype,"vote",null),Object(a.__decorate)([Object(it.b)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",["function"===typeof(S="undefined"!==typeof ot.a&&ot.a)?S:Object]),Object(a.__metadata)("design:returntype","function"===typeof(x="undefined"!==typeof ot.a&&ot.a)?x:Object)],t.prototype,"deleteComment",null),Object(a.__decorate)([Object(it.b)(),Object(a.__metadata)("design:type",Function),Object(a.__metadata)("design:paramtypes",["function"===typeof(I="undefined"!==typeof ot.a&&ot.a)?I:Object]),Object(a.__metadata)("design:returntype","function"===typeof(F="undefined"!==typeof ot.a&&ot.a)?F:Object)],t.prototype,"searchUser",null),t=Object(a.__decorate)([Object(at.a)(),Object(a.__metadata)("design:paramtypes",["function"===typeof(P="undefined"!==typeof mt.a&&mt.a)?P:Object])],t)}(rt.a),yn=Object(z.d)(bn||(bn=Object(a.__makeTemplateObject)(["\n  0% {\n    bottom: 0;\n  }\n  100% {\n    bottom: -800%;\n  }\n"],["\n  0% {\n    bottom: 0;\n  }\n  100% {\n    bottom: -800%;\n  }\n"]))),hn=function(e){var t="white"===e.type;return{backgroundColor:t?f.a.grey(0):f.a.grey(2),position:"relative",overflow:"hidden","&::before":{content:'""',borderRadius:"3px",position:"absolute",width:"100%",height:"900%",bottom:0,backgroundImage:"linear-gradient(5deg, "+(t?f.a.grey(0):f.a.grey(1))+" 30%, "+(t?f.a.grey(1):f.a.grey(0))+" 50%, "+(t?f.a.grey(0):f.a.grey(1))+" 70%)",animation:yn+" 1.4s linear infinite"}}},On=Object(H.a)("div",{target:"e1hucbtw0"})({display:"flex",flexDirection:"column",margin:"20px 0 0",width:"100%","&:nth-last-type-of(1)":{marginBottom:"20px"}},"label:LoadingCard;"),jn=Object(H.a)("div",{target:"e1hucbtw1"})({display:"flex",alignItems:"center"},"label:HeadRow;"),_n=Object(H.a)("div",{target:"e1hucbtw2"})(hn,{width:"32px",height:"32px",borderRadius:"50%"},"label:LoadingcardImage;"),Nn={height:"15px"},Cn=Object(H.a)("div",{target:"e1hucbtw3"})(hn,Object(a.__assign)(Object(a.__assign)({},Nn),{flex:"0 1 100px",margin:"0 0 0 10px"}),"label:Row1;"),Sn=Object(H.a)("div",{target:"e1hucbtw4"})(hn,Object(a.__assign)(Object(a.__assign)({},Nn),{width:"100%",margin:"10px 0 0"}),"label:Row2;"),xn=Object(H.a)("div",{target:"e1hucbtw5"})(hn,Object(a.__assign)(Object(a.__assign)({},Nn),{width:"100%",maxWidth:"200px",margin:"10px 0 0"}),"label:Row3;"),In=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){return u.a.createElement(On,null,u.a.createElement(jn,null,u.a.createElement(_n,{type:this.props.type}),u.a.createElement(Cn,{type:this.props.type})),u.a.createElement(Sn,{type:this.props.type}),u.a.createElement(xn,{type:this.props.type}))},t.defaultProps={type:"gray"},t}(u.a.PureComponent),Fn=Object(c.memo)((function(e){var t=Object(a.__read)(Object(c.useState)(!1),2),n=t[0],r=t[1],o=Object(a.__read)(Object(c.useState)(!1),2),d=o[0],l=o[1],s=Object(a.__read)(Object(c.useState)(!!e.shouldRenderReplies),2),b=s[0],v=s[1],h=Object(a.__read)(Object(c.useState)(!1),2),j=h[0],_=h[1],N=Object(c.useRef)(null),C=Object(a.__read)(Object(i.a)(kn,{scope:e.topicId}),2),S=C[0],x=C[1],I=Object(c.useContext)(m.d),F=Object(B.b)(),P=e.comment,E=P.id,R=P.post,w=P.isEdited,D=R.author,A=e.parentId||E,U=S.replyMap,z=(e.level>0?U.get(E):U.get(e.parentId))||{},H=z.page,$=void 0===H?1:H,q=z.replyCount,L=void 0===q?0:q,W=z.orderBy,K=void 0===W?g.A.OldToNew:W;Object(c.useEffect)((function(){O.a.prepare(),b&&x.getCommentReply({commentId:E,page:$,orderBy:K})}),[b,E,$,K]),Object(c.useEffect)((function(){E===S.parentId&&S.highlightCommentId&&v(!0)}),[E,S.parentId,S.highlightCommentId]);var G=I.userSlug===D.profile.userSlug||!!I.isSuperuser,Y=function(){var e;v(!1),x.setHighlightCommentId(null),null===(e=N.current)||void 0===e||e.scrollIntoView()},Q=Object(c.useCallback)((function(e){x.updateCommentReplyOrderBy({commentId:E,orderBy:e})}),[E]),J=Object(c.useCallback)((function(e){var t;x.updateCommentReplyPage({commentId:E,page:e}),x.setHighlightCommentId(E),null===(t=N.current)||void 0===t||t.scrollIntoView()}),[E]),Z=S.highlightCommentId===e.comment.id,ee=S.parentId===e.comment.id,te=e.parentId===S.highlightCommentId;return!S.highlightCommentId||b||Z||te||ee?u.a.createElement(u.a.Fragment,null,u.a.createElement(Yt,{isAbleToMutate:G,parentId:A,shouldShowDeleteConfirm:n,commentId:E,numChildren:e.comment.numChildren||0,onDelete:function(t,n){var a=t!==n;x.deleteComment(parseInt(n,10)),a&&x.deleteReply({id:n,parentId:t}),x.setTotalNumByDiff(-1),r(!1),e.tracker.confirmDeleteComment(t===n?void 0:t)},onHideDelete:function(){r(!1),e.tracker.cancelDeleteComment(A===E?void 0:A)}}),u.a.createElement(M.a,{visible:j,onClose:function(){_(!1)},resourceType:g.ic.Comment,resourceId:E}),u.a.createElement(X,{ref:N,onMouseEnter:function(){l(!0)},onMouseLeave:function(){l(!1)}},u.a.createElement(re,null,u.a.createElement(oe,null,u.a.createElement("a",{href:k.a.main.paths.publicProfile.home({userSlug:D.profile.userSlug}),target:"_blank"},u.a.createElement(de,{src:D.profile.userAvatar,alt:D.username}),u.a.createElement(V.a,{userSlug:D.profile.userSlug,realName:D.profile.realName+(e.topicAuthorSlug===D.profile.userSlug?" (\u4f5c\u8005)":""),defaultColor:f.a.grey(7),className:le}))),u.a.createElement(ce,{"data-status":R.status},"Deleted"===R.status&&"\u5df2\u5220\u9664","Pending"===R.status&&"\u5ba1\u6838\u4e2d",w&&"\uff08\u7f16\u8f91\u8fc7\uff09",["Deleted","Pending"].indexOf(R.status)<0&&Object(y.a)(1e3*R.creationDate))),u.a.createElement(p.a,null,u.a.createElement(Kt,{topicId:S.topicId,commentId:E,post:R,shouldShowCommentEditor:S.editingId===E,onHideEditComment:function(){x.setEditingId(null)},tracker:e.tracker})),u.a.createElement(p.a,{css:ve},u.a.createElement(en,{comment:e.comment,shouldRenderReplies:b,shouldShowReplyBox:S.replyingId===E,shouldShowMoreTools:d,isAbleToMutate:G,generateShareUrl:e.generateShareUrl,onShowReplyBox:function(){T.a.ensurePhoneVerified((function(){x.setReplyingId(E)}),{user:I})()},onShowReplies:function(){v(!0)},onCloseReplies:Y,toggleVote:function(e,t,n){T.a.ensureVerified(F((function(){x.vote({postId:e,status:t,newCount:n}),x.updateVoteCache({commentId:E,parentId:A,postId:e,status:t,newCount:n})}),[g.t.Posting]),{user:I})()},toggleFlag:function(){T.a.ensureVerified((function(){_(!0)}),{user:I})()},toggleDelete:function(){r(!0),e.tracker.deleteComment(A===E?void 0:A)},editComment:function(){x.setEditingId(E)}})),S.replyingId===E&&u.a.createElement(Qt,{comment:e.comment,topicId:S.topicId,tracker:e.tracker,parentId:A,onSubmit:function(t){x.setReplyingId(null);var n=e.level>0?E:e.parentId;x.updateCommentCount({comment:t,id:n}),1===$&&K===g.A.NewToOld?x.getCommentReply({commentId:n,page:$,orderBy:K}):(x.updateCommentReplyPage({commentId:n,page:1}),x.updateCommentReplyOrderBy({commentId:n,orderBy:g.A.NewToOld})),function(e){x.setHighlightCommentId(e)}(e.parentId||e.comment.id),v(!0)},onHideReplyBox:function(){x.setReplyingId(null),e.tracker.cancelComment()}}),b&&e.level>0&&u.a.createElement(Rn,{topicAuthorSlug:e.topicAuthorSlug,activeOption:K,onOptionClick:Q,commentId:E,reply:z,generateShareUrl:e.generateShareUrl,tracker:e.tracker,page:$,totalNum:L,setRepliesPage:J,hideReplies:Y,resetCommentReply:function(){x.updateResetCommentReply(E)},level:e.level,topicId:e.topicId}))):null})),Pn=(vn=new h.a,function(e){var t=Object(a.__read)(Object(c.useState)(!1),2),n=t[0],i=t[1],r=e.maxReplyDepth,o=Object(a.__rest)(e,["maxReplyDepth"]);return Object(c.useEffect)((function(){var t=vn.add((function(){var t=e.comment.post,n=t.content,a=t.mentionedUsers,i={};a&&a.forEach((function(e){e&&(i[e.nickName]=e.userSlug)})),S(i),A().render(n)})),n=vn.add((function(){i(!0)}));return function(){t(),n()}}),[]),n?u.a.createElement(Fn,Object(a.__assign)({level:r},o)):null}),En=Object(c.memo)((function(e){var t=e.reply,n=t.replies,a=void 0===n?[]:n,i=t.loading,r=void 0===i||i,d=Object(v.a)().getUsernameConfigs,l=a.map((function(t){return u.a.createElement(Fn,{key:t.node.id,topicAuthorSlug:e.topicAuthorSlug,comment:t.node,parentId:e.commentId,generateShareUrl:e.generateShareUrl,level:e.level-1,tracker:e.tracker,topicId:e.topicId})}));return Object(c.useEffect)((function(){var e=a.map((function(e){var t,n;return null===(n=null===(t=e.node)||void 0===t?void 0:t.post.author)||void 0===n?void 0:n.profile.userSlug}));d(o()(e))}),[d,a]),r?u.a.createElement(ue,null,u.a.createElement(In,null),u.a.createElement(In,null)):u.a.createElement(ue,null,l)})),Rn=Object(c.memo)((function(e){return u.a.createElement(fe,null,u.a.createElement(Oe,{activeOption:e.activeOption,onOptionClick:e.onOptionClick}),u.a.createElement(En,{topicAuthorSlug:e.topicAuthorSlug,orderBy:e.activeOption,commentId:e.commentId,reply:e.reply,tracker:e.tracker,generateShareUrl:e.generateShareUrl,hideReplies:e.hideReplies,level:e.level,topicId:e.topicId}),u.a.createElement(Ne,{page:e.page,totalNum:e.totalNum,setRepliesPage:e.setRepliesPage,hideReplies:e.hideReplies,resetCommentReply:e.resetCommentReply}))})),wn=n("daAW"),Dn=Object(H.a)("div",{target:"ei9q7no0"})(Se.a.disable,{margin:"30px 0 50px",textAlign:"center",fontSize:"20px",lineHeight:1.4},"label:EmptyPlaceHolder;"),An=Object(H.a)("div",{target:"ei9q7no1"})({display:"flex",alignItems:"stretch",flexDirection:"column",minHeight:"100%",WebkitOverflowScrolling:"touch"},"label:DiscussWrapper;"),Tn=Object(H.a)("div",{target:"ei9q7no2"})({display:"flex",flex:"0 0 auto",flexDirection:"column"},"label:DiscussContent;");Tn.defaultProps=Object(a.__assign)(Object(a.__assign)({},Tn.defaultProps),{"data-cypress":"DiscussContent"});var Bn=Object(H.a)((function(e){var t=e.className,n=Object(a.__rest)(e,["className"]);return u.a.createElement("div",{className:t,"data-cypress":"CommentPagination"},u.a.createElement(je.a,Object(a.__assign)({},n)))}),{target:"ei9q7no3"})({margin:"30px 0",display:"flex",justifyContent:"center"},"label:CommentPagination;"),Mn=Object(H.a)("div",{target:"ei9q7no4"})(Se.a.disable,{position:"relative",margin:"10px 0",textAlign:"center","&::before, &::after":{position:"absolute",top:"10px",content:'""',width:"calc(50% - 60px)",height:"1px",background:"currentColor"},"&::before":{left:0},"&::after":{right:0}},"label:CommentsHead;"),Vn=Object(H.a)(wn.a,{target:"ei9q7no5"})({color:f.b.LabelTertiary(),fontSize:"12px",lineHeight:"16px",margin:"9px 0",textAlign:"center"},"label:CheckBar;"),Un=n("5ZzG"),zn=n("rF4R"),Hn=n("P4jA"),$n=[{name:"\u6700\u70ed",key:g.z.Hot},{name:"\u6700\u65b0",key:g.z.NewToOld},{name:"\u6700\u65e9",key:g.z.OldToNew}],qn=u.a.memo((function(e){var t=e.activeOption,n=e.onOptionSelect,i=Object(a.__read)(u.a.useState(!1),2),r=i[0],o=i[1],d=u.a.useCallback((function(e){n(e),o(!1)}),[n,o]);return u.a.createElement(zn.a,{trigger:"click",placement:"bottom-end",isActive:r,onChangeActive:o,content:u.a.createElement(Hn.a,{onSelect:d,selectedKey:t},$n.map((function(e){var t=e.name,n=e.key;return u.a.createElement(Hn.a.Item,{key:n},t)})))},u.a.createElement(G.a,{suffixIcon:u.a.createElement(Un.a,{type:"rank"}),kind:"transparent",size:"xs"},$n[$n.findIndex((function(e){return e.key===t}))].name))})),Ln=n("A+MG"),Wn=Object(c.memo)((function(e){return u.a.createElement(Ln.a,{id:"comment-box-ele"},u.a.createElement(Ln.g,null,u.a.createElement(Ln.b,null,u.a.createElement(Ln.c,null,null!==e.commentNum?e.commentNum:"-"),"\u6761\u8bc4\u8bba",u.a.createElement(Ln.f,{type:"debug"})),u.a.createElement(qn,{activeOption:e.orderBy,onOptionSelect:e.onChangeOrderBy})),e.isActive&&u.a.createElement(Ln.d,null,u.a.createElement(p.a,null,u.a.createElement(Wt,{topicId:e.topicId,tracker:e.tracker,onSubmitted:e.onSubmitted,userStatus:e.userStatus}))))})),Kn=Object(c.memo)((function(e){var t=Object(a.__read)(Object(i.a)(kn,{scope:e.topicId}),1)[0],n=Object(v.a)().getUsernameConfigs,r=function(n){return n?u.a.createElement(p.a,{key:n.id},u.a.createElement(Pn,{topicAuthorSlug:e.topicAuthorSlug,comment:n,shouldRenderReplies:n.id===t.parentId,generateShareUrl:e.generateShareUrl,tracker:e.tracker,maxReplyDepth:1,topicId:e.topicId})):null},d=t.comments.edges,m=t.commentsSelection,g=m&&m.length?m.map(r):null,b=l()(o()(d).map((function(e){return e.node})),m,"id").map(r);return Object(c.useEffect)((function(){var e=o()(d).map((function(e){var t,n;return null===(n=null===(t=e.node)||void 0===t?void 0:t.post.author)||void 0===n?void 0:n.profile.userSlug}));n(o()(e))}),[d,n]),t.loadingComments?u.a.createElement(u.a.Fragment,null,u.a.createElement(In,null),u.a.createElement(In,null)):d.length?u.a.createElement(Tn,null,!!g&&u.a.createElement(Mn,null,"\u7cbe\u9009\u8bc4\u8bba(",m.length,")"),g,!!g&&u.a.createElement(Mn,null,"\u8bc4\u8bba(",Object(s.c)(t.totalNum||0),")"),b):u.a.createElement(Dn,null,"\u6682\u65e0\u8bc4\u8bba")})),Gn=Object(c.memo)((function(e){var t,n=e.topicId,r=Object(a.__read)(Object(i.a)(kn,{scope:n}),2),o=r[0],d=r[1];return o.loadingComments||null!==o.topLevelNum&&o.topLevelNum<=15?null:u.a.createElement(p.a,null,u.a.createElement(Bn,{current:o.currentPage,numPerPage:15,totalNum:null!==(t=o.topLevelNum)&&void 0!==t?t:0,onChange:function(e){e!==o.currentPage&&d.setCurrentPage(e)}}))}));function Yn(e){var t=e.count,n=e.to;return u.a.createElement(Vn,{replace:!0,to:n},"\u67e5\u770b ",t," \u6761\u8bc4\u8bba")}var Qn=Object(c.memo)((function(e){var t=Object(a.__read)(Object(i.a)(kn,{scope:e.topicId}),2),n=t[0],r=t[1],o=Object(c.useContext)(m.d);Object(c.useEffect)((function(){e.isActive&&(r.setTopicId(e.topicId),r.getCurrentPage(),r.getTotalNum())}),[e.isActive,e.topicId,n.order,n.currentPage]),Object(c.useEffect)((function(){var t;e.isActive&&((t=e.sharedCommentId)&&/^\d+$/.test(t))&&r.getPageInfo(e.sharedCommentId)}),[e.isActive,e.sharedCommentId]),Object(c.useEffect)((function(){r.setHighlightCommentId(e.sharedCommentId)}),[e.sharedCommentId]);var d=Object(c.useMemo)((function(){return"function"===typeof e.generateDescription?u.a.createElement(b.a,Object(a.__assign)({},e.generateDescription(n))):null}),[e.generateDescription,n]);return u.a.createElement(u.a.Fragment,null,d,u.a.createElement(An,null,u.a.createElement(p.a,null,u.a.createElement(Wn,{isActive:e.isActive,topicId:e.topicId,commentNum:n.totalNum,orderBy:n.order,tracker:e.tracker,onSubmitted:function(e){r.setHighlightCommentId(e.id),r.setTotalNumByDiff(1),n.order===g.z.NewToOld&&1===n.currentPage?r.getCurrentPage():(r.setOrderBy(g.z.NewToOld),r.setCurrentPage(1))},onChangeOrderBy:function(e){r.setOrderBy(e)},userStatus:o})),u.a.createElement(Kn,Object(a.__assign)({},e,{userStatus:o})),!e.sharedCommentId&&u.a.createElement(Gn,{topicId:e.topicId}),e.sharedCommentId&&u.a.createElement(Yn,{count:n.totalNum,to:e.backPath})))}))},a9yc:function(e,t,n){"use strict";n.d(t,"d",(function(){return p})),n.d(t,"f",(function(){return g})),n.d(t,"e",(function(){return b})),n.d(t,"h",(function(){return v})),n.d(t,"b",(function(){return f})),n.d(t,"g",(function(){return k})),n.d(t,"a",(function(){return y})),n.d(t,"c",(function(){return h}));var a,i,r,o,d,l,c,u,s=n("f7k3"),m=n("fgAA"),p=Object(s.b)(((a={".ant-form-item-explain.ant-form-item-explain-error":{color:m.a.red(5)}})[m.c]={".ant-form-item-label":{label:{color:m.a.grey(7)}}},a),"label:formColors;"),g=Object(s.b)(((i={})[m.c]={".ant-modal-content":{background:m.a.grey(3)},".ant-modal-header":{background:m.a.grey(3)},".ant-modal-close-x, .ant-modal-title":{color:m.a.grey(8)}},i),"label:modalColors;"),b=Object(s.b)(((r={})[m.c]={".ant-input-affix-wrapper":{backgroundColor:m.a.grey(3),borderColor:m.a.grey(4),"&:hover":{borderColor:m.a.primary(6)}},".ant-input, .ant-input[disabled]":{background:m.a.grey(3),color:m.a.grey(8),borderColor:m.a.grey(4),"&:hover":{borderColor:m.a.primary(6)}},".ant-input-group-addon":{background:m.a.grey(3),color:m.a.grey(8)},".ant-input-suffix svg":{color:m.a.grey(5)},".ant-input-group-addon .ant-select.ant-select-single .ant-select-selector":{borderColor:m.a.grey(4),"&:hover":{borderColor:m.a.primary(6)}},".ant-input-affix-wrapper-disabled":{"&:hover":{borderColor:m.a.grey(4)}},".ant-form-item-has-error":{".ant-input, .ant-input-affix-wrapper":{"&, &:hover":{background:m.a.grey(3),borderColor:m.a.red(5)}},".ant-input-group-addon":{borderColor:m.a.red(5)}}},r),"label:inputColors;"),v=Object(s.b)(((o={})[m.c]={".ant-select, .ant-select.ant-select-disabled":{"&:not(.ant-select-customize-input) .ant-select-selector":{background:m.a.grey(3),borderColor:m.a.grey(4),color:m.a.grey(8)}},".ant-select-arrow":{color:m.a.grey(5)},".ant-select-dropdown":{color:m.a.grey(8),backgroundColor:m.a.grey(0),border:"1px solid "+m.a.grey(4)},".ant-select-item-option":{color:m.a.grey(8),"&-selected, &-active":{"&:not(.ant-select-item-option-disabled)":{backgroundColor:m.a.grey(9,.1),color:m.a.grey(8)}},"&:hover":{backgroundColor:m.a.grey(9,.15)}},".ant-form-item-has-error:not(.ant-select-disabled):not(.ant-select-customize-input) .ant-select .ant-select-selector":{background:"transparent",borderColor:m.a.red(5)+" !important"}},o),"label:selectColors;"),f=Object(s.b)(((d={})[m.c]={".ant-checkbox-checked .ant-checkbox-inner":{borderColor:m.a.primary(5),background:m.a.primary(5)},".ant-checkbox-inner":{background:m.a.grey(3),border:"2px solid "+m.a.grey(4),color:m.a.grey(8)},".ant-checkbox-wrapper":{color:m.a.grey(8)},".ant-checkbox-disabled + span":{color:m.a.grey(8)}},d),"label:checkboxColors;"),k=Object(s.b)(((l={})[m.c]={".ant-radio-wrapper":{color:m.a.grey(8),"&-checked, &:hover":{".ant-radio-inner":{borderColor:m.a.primary(5)}}},".ant-radio-inner":{background:m.a.grey(3),borderColor:m.a.grey(5)}},l),"label:radioColors;"),y=Object(s.b)(((c={})[m.c]={".ant-btn-primary[disabled]":{background:m.a.grey(6)}},c),"label:buttonColors;"),h=Object(s.b)(((u={})[m.c]={".ant-picker":{background:m.a.grey(3),borderColor:m.a.grey(5),"&:hover":{borderColor:m.a.primary(5)}},".ant-picker-input > input":{color:m.a.grey(8)},".ant-picker-suffix":{color:m.a.grey(5)},".ant-picker-clear":{color:m.a.grey(5),backgroundColor:m.a.grey(3)},".ant-picker-panel":{border:0},".ant-picker-panel-container":{background:m.a.grey(4)},".ant-picker-cell":{color:m.a.grey(6),"&:hover .ant-picker-cell-inner":{background:m.a.grey(5)+" !important"}},".ant-picker-cell-in-view":{color:m.a.grey(8)},".ant-picker-header":{color:m.a.grey(8),borderBottom:"1px solid "+m.a.grey(4),button:{color:m.a.grey(8)}},".ant-form-item-has-error .ant-picker":{"&, &:not([disabled]):hover":{background:m.a.grey(3),borderColor:m.a.red(5)}}},u),"label:datePickerColors;")},r3KU:function(e,t,n){"use strict";n.d(t,"b",(function(){return I})),n.d(t,"a",(function(){return T}));var a=n("D57K"),i=n("K/af"),r=n("ERkP"),o=n.n(r),d=n("xqpu"),l=n("rF4R"),c=n("veEq"),u=n("rBFF"),s=n("uhc8"),m=n("TMWK"),p=n("fgAA"),g=n("g06B"),b=n("/NrN"),v=n("7a+J"),f=n("CkJS"),k=Object(m.a)(g.a,{target:"e1e0m4n00"})(v.a.modal,{background:p.b.White(),borderRadius:"13px",width:"352px",minWidth:"unset",minHeight:"unset"},"label:CustomModal;"),y=Object(m.a)("div",{target:"e1e0m4n01"})({display:"flex",alignItems:"center",justifyContent:"space-between","> svg":{fontSize:"24px",color:p.b.BaseGrey6(),cursor:"pointer"}},"label:Header;"),h=Object(m.a)("span",{target:"e1e0m4n02"})({fontSize:"18px",display:"flex",alignItems:"center","> svg":{fontSize:"20px",color:p.b.Warning(),marginRight:"8px"}},"label:Title;"),O=Object(m.a)("div",{target:"e1e0m4n03"})(f.a.paragraph.md,{color:p.b.LabelSecondary(),marginTop:"27px",marginBottom:"28px"},"label:Message;"),j=Object(m.a)("span",{target:"e1e0m4n04"})({color:p.b.RedStandard(),margin:"0 4px"},"label:UserName;"),_=Object(m.a)("div",{target:"e1e0m4n05"})({display:"flex",justifyContent:"flex-end"},"label:Footer;"),N=Object(m.a)(b.a,{target:"e1e0m4n06"})({borderRadius:"5px",padding:"6px 24px",lineHeight:"20px",fontWeight:500,cursor:"pointer",":not(:first-of-type)":{marginLeft:"16px"}},"label:StyledButton;"),C=n("HTDA");function S(e){var t=e.onConfirm,n=Object(a.__read)(Object(i.a)(C.a),2),r=n[0],d=r.isModalActive,l=r.currentOfficialAccount,c=n[1].hideModal,m=o.a.useCallback((function(){c(),t()}),[t,c]);return o.a.useEffect((function(){return function(){c()}}),[]),o.a.createElement(k,{isActive:d,onClickOutside:c,contentPadding:"20px"},o.a.createElement(y,null,o.a.createElement(h,null,o.a.createElement(u.a,null),"\u63d0\u793a"),o.a.createElement(s.a,{onClick:c})),o.a.createElement(O,null,"\u786e\u5b9a\u4ee5",o.a.createElement(j,null,null===l||void 0===l?void 0:l.realName),"\u7684\u8eab\u4efd\u53d1\u5e03\u6b64\u8ba8\u8bba\uff1f"),o.a.createElement(_,null,o.a.createElement(N,{kind:"primary",onClick:m},"\u786e\u8ba4"),o.a.createElement(N,{onClick:c},"\u53d6\u6d88")))}var x,I,F=n("f7k3"),P=Object(F.b)(v.a.commandBars,{border:"none",padding:"8px"},"label:containerStyle;"),E=Object(F.b)({transition:"all 0.4s",":hover":{background:p.b.FillQuaternary()}},"label:hover;"),R=Object(m.a)("span",{target:"ey3c3590"})(E,f.a.paragraph.sm,{color:p.b.RedStandard(),cursor:"pointer",display:"flex",alignItems:"center",borderRadius:"5px",padding:"4px 9px",svg:{fontSize:"16px",marginLeft:"6px"}},"label:MockButton;"),w=Object(m.a)("div",{target:"ey3c3591"})({listStyleType:"none"},"label:UserList;"),D=Object(m.a)("div",{target:"ey3c3592"})(E,{color:p.b.LabelSecondary(),padding:"6px 8px",cursor:"pointer",":hover":{background:p.b.FillQuaternary()}},"label:UserItem;");!function(e){e[e.Publish=0]="Publish",e[e.Reply=1]="Reply"}(I||(I={}));var A=((x={})[I.Publish]="columnsOfficialPublishArticle",x[I.Reply]="officialCreateCnComment",x);function T(e){var t=e.onConfirm,n=e.mockMode,r=Object(a.__read)(Object(i.a)(C.a),2),u=r[0].officialAccounts,s=r[1],m=s.showModal,p=s.fetchOfficialAccounts,g=s.setCurrentOfficialAccount,b=Object(a.__read)(o.a.useState(!1),2),v=b[0],f=b[1],k=o.a.useContext(d.d),y=k.userPermissions,h=k.fieldPermissions,O=o.a.useMemo((function(){return h[A[n]]}),[h,n]),j=null===O||void 0===O?void 0:O.every((function(e){return y.includes(e)}));o.a.useEffect((function(){j&&p({})}),[p,j]);var _=o.a.useCallback((function(e){return function(){g(e),f(!1),m()}}),[g,m]);if(!j)return null;var N=u.length?o.a.createElement(w,null,u.map((function(e){return o.a.createElement(D,{key:e.realName,onClick:_(e)},e.realName)}))):"\u6682\u65e0\u53ef\u7528\u9a6c\u7532";return o.a.createElement(o.a.Fragment,null,o.a.createElement(l.a,{placement:"bottom",content:N,containerStyle:P,isActive:v,onChangeActive:f},o.a.createElement(R,null,"Mock \u53d1\u5e03",o.a.createElement(c.a,null))),o.a.createElement(S,{onConfirm:t}))}},rBFF:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n("D57K"),i=n("ERkP"),r=n.n(i),o=n("GG6d"),d=r.a.forwardRef((function(e,t){return r.a.createElement(o.a,Object(a.__assign)({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"1em",height:"1em",fill:"currentColor",ref:t},e),r.a.createElement("path",{fillRule:"evenodd",d:"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm0-8.5a1 1 0 001-1v-4a1 1 0 10-2 0v4a1 1 0 001 1zm0 3a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"}))}))},sOys:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n("D57K"),i=n("D02H"),r=n("7j1U"),o=n("Hn49"),d=n("WDwU");function l(e){var t=e.children,n=Object(a.__rest)(e,["children"]),i=Object(d.b)(t);return Object(o.a)(Object(a.__assign)({options:i,createHandleItemClick:function(e){var t=e.disabled,n=e.onClick;if(!t)return n}},n))}l.Item=i.a,l.ItemGroup=r.a},uC9H:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n("D57K"),i=n("ERkP"),r=n.n(i),o=n("GG6d"),d=r.a.forwardRef((function(e,t){return r.a.createElement(o.a,Object(a.__assign)({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"1em",height:"1em",fill:"currentColor",ref:t},e),r.a.createElement("path",{fillRule:"evenodd",d:"M7 6a1 1 0 011-1h13a1 1 0 110 2H8a1 1 0 01-1-1zm1 13a1 1 0 110-2h13a1 1 0 010 2H8zm0-6a1 1 0 110-2h13a1 1 0 010 2H8zM2.756 4.98l.236-1.18h2.22l-.92 4.6h-1.38l.684-3.42h-.84zm2.823 8.3l-.235 1.192H1.756l.174-.87.073-.117 1.911-1.498c.219-.178.368-.324.445-.434a.49.49 0 00.099-.287.208.208 0 00-.083-.18c-.067-.052-.176-.082-.335-.082a.897.897 0 00-.398.094 1.02 1.02 0 00-.342.272l-.12.144-.968-.702.118-.162c.193-.264.456-.473.786-.625.327-.15.684-.225 1.068-.225.318 0 .602.053.85.16.255.11.456.267.6.47.146.206.22.44.22.698 0 .298-.083.58-.247.839-.158.25-.424.518-.797.807l-.653.506h1.422zm-3.063 3.7l.245-1.18h3.345l-.166.867-.06.11-.93.869a1.205 1.205 0 01.737 1.144c-.001.327-.098.622-.29.881a1.856 1.856 0 01-.774.593c-.322.139-.685.208-1.087.208-.328 0-.636-.045-.924-.135a2.06 2.06 0 01-.743-.4l-.132-.114.688-1.05.173.147c.12.103.267.185.442.245.177.06.364.091.562.091.251 0 .435-.044.554-.124a.31.31 0 00.146-.282c0-.086-.025-.135-.08-.171-.076-.05-.213-.079-.41-.079h-.687l.173-.88.06-.108.674-.632H2.516z",clipRule:"evenodd"}))}))},wgQk:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n("D57K"),i=n("ERkP"),r=n.n(i),o=n("GG6d"),d=r.a.forwardRef((function(e,t){return r.a.createElement(o.a,Object(a.__assign)({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"1em",height:"1em",fill:"currentColor",ref:t},e),r.a.createElement("path",{fillRule:"evenodd",d:"M8 7a1 1 0 110-2h13a1 1 0 110 2H8zm0 6a1 1 0 110-2h13a1 1 0 110 2H8zm0 6a1 1 0 110-2h13a1 1 0 110 2H8zM2.952 6.85a1.201 1.201 0 111.698-1.7 1.201 1.201 0 01-1.698 1.7zm0 6a1.201 1.201 0 111.698-1.7 1.201 1.201 0 01-1.698 1.7zm0 6a1.201 1.201 0 111.698-1.7 1.201 1.201 0 01-1.698 1.7z",clipRule:"evenodd"}))}))},x8uP:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n("43mT"),i=Object(a.a)({postPostListExposure:function(e,t,n,a,i,r){return{gio:{data:{post_article_type:e,post_article_slug:t,post_url:n,post_article_author:a,post_timestamp:i,post_actor_slug:r}}}},postPostListClick:function(e,t,n,a,i,r){return{gio:{data:{post_article_type:e,post_article_slug:t,post_url:n,post_article_author:a,post_timestamp:i,post_actor_slug:r}}}}})}}]);